{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# The Objective\n",
    "\n",
    "## Which is the better plan?\n",
    "\n",
    "You work as an analyst for the telecom operator Megaline. The company offers its clients two prepaid plans, Surf and Ultimate. The commercial department wants to know which of the plans brings in more revenue in order to adjust the advertising budget.\n",
    "\n",
    "You are going to carry out a preliminary analysis of the plans based on a relatively small client selection. You'll have the data on 500 Megaline clients: who the clients are, where they're from, which plan they use, and the number of calls they made and text messages they sent in 2018. Your job is to analyze the clients' behavior and determine which prepaid plan brings in more revenue."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Initialization"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Loading all the libraries\n",
    "import pandas as pd\n",
    "import scipy.stats as st\n",
    "import math as mt\n",
    "import random\n",
    "from matplotlib import pyplot as plt\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Load data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Load the data files into different DataFrames\n",
    "calls = pd.read_csv('/datasets/megaline_calls.csv')\n",
    "\n",
    "internet = pd.read_csv('/datasets/megaline_internet.csv')\n",
    "\n",
    "messages = pd.read_csv('/datasets/megaline_messages.csv')\n",
    "\n",
    "plans = pd.read_csv('/datasets/megaline_plans.csv')\n",
    "\n",
    "users = pd.read_csv('/datasets/megaline_users.csv')\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Prepare the data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The users table (data on users):\n",
    "        user_id — unique user identifier\n",
    "        \n",
    "        first_name — user's name\n",
    "        \n",
    "        last_name — user's last name\n",
    "        \n",
    "        age — user's age (years)\n",
    "        \n",
    "        reg_date — subscription date (dd, mm, yy)\n",
    "        \n",
    "        churn_date — the date the user stopped using the service (if the value is missing, the calling plan was being used when this database was extracted)\n",
    "        \n",
    "        city — user's city of residence\n",
    "        \n",
    "        plan — calling plan name\n",
    "        \n",
    "        \n",
    "The calls table (data on calls):\n",
    "\n",
    "        id — unique call identifier\n",
    "        \n",
    "        call_date — call date\n",
    "        \n",
    "        duration — call duration (in minutes)\n",
    "        \n",
    "        user_id — the identifier of the user making the call\n",
    "        \n",
    "        \n",
    "The messages table (data on texts):\n",
    "\n",
    "        id — unique text message identifier\n",
    "        \n",
    "        message_date — text message date\n",
    "        \n",
    "        user_id — the identifier of the user sending the text\n",
    "        \n",
    "        \n",
    "The internet table (data on web sessions):\n",
    "\n",
    "        id — unique session identifier\n",
    "        \n",
    "        mb_used — the volume of data spent during the session (in megabytes)\n",
    "        \n",
    "        session_date — web session date\n",
    "        \n",
    "        user_id — user identifier\n",
    "        \n",
    "        \n",
    "The plans table (data on the plans):\n",
    "\n",
    "        plan_name — calling plan name\n",
    "        \n",
    "        usd_monthly_fee — monthly charge in US dollars\n",
    "        \n",
    "        minutes_included — monthly minute allowance\n",
    "        \n",
    "        messages_included — monthly text allowance\n",
    "        \n",
    "        mb_per_month_included — data volume allowance (in megabytes)\n",
    "        \n",
    "        usd_per_minute — price per minute after exceeding the package limits (e.g., if the package includes 100 minutes, the 101st minute will be charged)\n",
    "        \n",
    "        usd_per_message — price per text after exceeding the package limits\n",
    "        \n",
    "        usd_per_gb — price per extra gigabyte of data after exceeding the package limits (1 GB = 1024 megabytes)\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Plans"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 2 entries, 0 to 1\n",
      "Data columns (total 8 columns):\n",
      " #   Column                 Non-Null Count  Dtype  \n",
      "---  ------                 --------------  -----  \n",
      " 0   messages_included      2 non-null      int64  \n",
      " 1   mb_per_month_included  2 non-null      int64  \n",
      " 2   minutes_included       2 non-null      int64  \n",
      " 3   usd_monthly_pay        2 non-null      int64  \n",
      " 4   usd_per_gb             2 non-null      int64  \n",
      " 5   usd_per_message        2 non-null      float64\n",
      " 6   usd_per_minute         2 non-null      float64\n",
      " 7   plan_name              2 non-null      object \n",
      "dtypes: float64(2), int64(5), object(1)\n",
      "memory usage: 256.0+ bytes\n",
      "None\n"
     ]
    }
   ],
   "source": [
    "# Print the general/summary information about the plans' DataFrame\n",
    "print(plans.info())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>messages_included</th>\n",
       "      <th>mb_per_month_included</th>\n",
       "      <th>minutes_included</th>\n",
       "      <th>usd_monthly_pay</th>\n",
       "      <th>usd_per_gb</th>\n",
       "      <th>usd_per_message</th>\n",
       "      <th>usd_per_minute</th>\n",
       "      <th>plan_name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>50</td>\n",
       "      <td>15360</td>\n",
       "      <td>500</td>\n",
       "      <td>20</td>\n",
       "      <td>10</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.03</td>\n",
       "      <td>surf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1000</td>\n",
       "      <td>30720</td>\n",
       "      <td>3000</td>\n",
       "      <td>70</td>\n",
       "      <td>7</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.01</td>\n",
       "      <td>ultimate</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   messages_included  mb_per_month_included  minutes_included  \\\n",
       "0                 50                  15360               500   \n",
       "1               1000                  30720              3000   \n",
       "\n",
       "   usd_monthly_pay  usd_per_gb  usd_per_message  usd_per_minute plan_name  \n",
       "0               20          10             0.03            0.03      surf  \n",
       "1               70           7             0.01            0.01  ultimate  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Print a sample of data for plans\n",
    "display(plans)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "I used info() to get a quick summary of the columns, missing values, and data types. There are only two plans, the usd_per_message and usd_per_minute are floats, the plan_name is type object and the rest are integers. Since the table is short I displayed the whole table. The internet included in the plan is in metabytes but the price of extra internet is in gigabytes, so below I will add a column to convert the mb_per_month_included to gigabytes. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Fix data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>messages_included</th>\n",
       "      <th>mb_per_month_included</th>\n",
       "      <th>minutes_included</th>\n",
       "      <th>usd_monthly_pay</th>\n",
       "      <th>usd_per_gb</th>\n",
       "      <th>usd_per_message</th>\n",
       "      <th>usd_per_minute</th>\n",
       "      <th>plan_name</th>\n",
       "      <th>gb_per_month_included</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>50</td>\n",
       "      <td>15360</td>\n",
       "      <td>500</td>\n",
       "      <td>20</td>\n",
       "      <td>10</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.03</td>\n",
       "      <td>surf</td>\n",
       "      <td>15.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1000</td>\n",
       "      <td>30720</td>\n",
       "      <td>3000</td>\n",
       "      <td>70</td>\n",
       "      <td>7</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.01</td>\n",
       "      <td>ultimate</td>\n",
       "      <td>30.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   messages_included  mb_per_month_included  minutes_included  \\\n",
       "0                 50                  15360               500   \n",
       "1               1000                  30720              3000   \n",
       "\n",
       "   usd_monthly_pay  usd_per_gb  usd_per_message  usd_per_minute plan_name  \\\n",
       "0               20          10             0.03            0.03      surf   \n",
       "1               70           7             0.01            0.01  ultimate   \n",
       "\n",
       "   gb_per_month_included  \n",
       "0                   15.0  \n",
       "1                   30.0  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plans['gb_per_month_included'] = plans['mb_per_month_included'] / 1024\n",
    "display(plans)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Users"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 500 entries, 0 to 499\n",
      "Data columns (total 8 columns):\n",
      " #   Column      Non-Null Count  Dtype \n",
      "---  ------      --------------  ----- \n",
      " 0   user_id     500 non-null    int64 \n",
      " 1   first_name  500 non-null    object\n",
      " 2   last_name   500 non-null    object\n",
      " 3   age         500 non-null    int64 \n",
      " 4   city        500 non-null    object\n",
      " 5   reg_date    500 non-null    object\n",
      " 6   plan        500 non-null    object\n",
      " 7   churn_date  34 non-null     object\n",
      "dtypes: int64(2), object(6)\n",
      "memory usage: 31.4+ KB\n",
      "None\n"
     ]
    }
   ],
   "source": [
    "# Print the general/summary information about the users' DataFrame\n",
    "\n",
    "print(users.info())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>first_name</th>\n",
       "      <th>last_name</th>\n",
       "      <th>age</th>\n",
       "      <th>city</th>\n",
       "      <th>reg_date</th>\n",
       "      <th>plan</th>\n",
       "      <th>churn_date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>427</th>\n",
       "      <td>1427</td>\n",
       "      <td>Zofia</td>\n",
       "      <td>Brock</td>\n",
       "      <td>64</td>\n",
       "      <td>Washington-Arlington-Alexandria, DC-VA-MD-WV MSA</td>\n",
       "      <td>2018-01-26</td>\n",
       "      <td>ultimate</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>137</th>\n",
       "      <td>1137</td>\n",
       "      <td>Allegra</td>\n",
       "      <td>Hopkins</td>\n",
       "      <td>20</td>\n",
       "      <td>Chicago-Naperville-Elgin, IL-IN-WI MSA</td>\n",
       "      <td>2018-10-02</td>\n",
       "      <td>surf</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>346</th>\n",
       "      <td>1346</td>\n",
       "      <td>Emmie</td>\n",
       "      <td>Gonzalez</td>\n",
       "      <td>59</td>\n",
       "      <td>Tucson, AZ MSA</td>\n",
       "      <td>2018-04-26</td>\n",
       "      <td>ultimate</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>362</th>\n",
       "      <td>1362</td>\n",
       "      <td>Kenyetta</td>\n",
       "      <td>Mcknight</td>\n",
       "      <td>65</td>\n",
       "      <td>Denver-Aurora-Lakewood, CO MSA</td>\n",
       "      <td>2018-01-18</td>\n",
       "      <td>surf</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>430</th>\n",
       "      <td>1430</td>\n",
       "      <td>Myung</td>\n",
       "      <td>Pugh</td>\n",
       "      <td>63</td>\n",
       "      <td>New York-Newark-Jersey City, NY-NJ-PA MSA</td>\n",
       "      <td>2018-12-07</td>\n",
       "      <td>surf</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     user_id first_name last_name  age  \\\n",
       "427     1427      Zofia     Brock   64   \n",
       "137     1137    Allegra   Hopkins   20   \n",
       "346     1346      Emmie  Gonzalez   59   \n",
       "362     1362   Kenyetta  Mcknight   65   \n",
       "430     1430      Myung      Pugh   63   \n",
       "\n",
       "                                                 city    reg_date      plan  \\\n",
       "427  Washington-Arlington-Alexandria, DC-VA-MD-WV MSA  2018-01-26  ultimate   \n",
       "137            Chicago-Naperville-Elgin, IL-IN-WI MSA  2018-10-02      surf   \n",
       "346                                    Tucson, AZ MSA  2018-04-26  ultimate   \n",
       "362                    Denver-Aurora-Lakewood, CO MSA  2018-01-18      surf   \n",
       "430         New York-Newark-Jersey City, NY-NJ-PA MSA  2018-12-07      surf   \n",
       "\n",
       "    churn_date  \n",
       "427        NaN  \n",
       "137        NaN  \n",
       "346        NaN  \n",
       "362        NaN  \n",
       "430        NaN  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "\n",
    "random.seed(15)\n",
    "display(users.sample(5))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "Using info() again lets me see that the only column with missing data is churn_date which only has data if customers cancel their plan. Customers begining and ending service is within the natural cycle of the business so I am going to keep all users information. user_id and age columns are the only integer datatypes and the rest are objects. I will now change the reg_date and churn_date into datetime datatypes. The other issue is the city column. The format is city, state, country (also misspelled), and some of the users have multiple cities and states. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Fix Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 500 entries, 0 to 499\n",
      "Data columns (total 8 columns):\n",
      " #   Column      Non-Null Count  Dtype         \n",
      "---  ------      --------------  -----         \n",
      " 0   user_id     500 non-null    int64         \n",
      " 1   first_name  500 non-null    object        \n",
      " 2   last_name   500 non-null    object        \n",
      " 3   age         500 non-null    int64         \n",
      " 4   city        500 non-null    object        \n",
      " 5   reg_date    500 non-null    datetime64[ns]\n",
      " 6   plan        500 non-null    object        \n",
      " 7   churn_date  34 non-null     datetime64[ns]\n",
      "dtypes: datetime64[ns](2), int64(2), object(4)\n",
      "memory usage: 31.4+ KB\n",
      "None\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>first_name</th>\n",
       "      <th>last_name</th>\n",
       "      <th>age</th>\n",
       "      <th>city</th>\n",
       "      <th>reg_date</th>\n",
       "      <th>plan</th>\n",
       "      <th>churn_date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1000</td>\n",
       "      <td>Anamaria</td>\n",
       "      <td>Bauer</td>\n",
       "      <td>45</td>\n",
       "      <td>Atlanta-Sandy Springs-Roswell, GA MSA</td>\n",
       "      <td>2018-12-24</td>\n",
       "      <td>ultimate</td>\n",
       "      <td>NaT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1001</td>\n",
       "      <td>Mickey</td>\n",
       "      <td>Wilkerson</td>\n",
       "      <td>28</td>\n",
       "      <td>Seattle-Tacoma-Bellevue, WA MSA</td>\n",
       "      <td>2018-08-13</td>\n",
       "      <td>surf</td>\n",
       "      <td>NaT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1002</td>\n",
       "      <td>Carlee</td>\n",
       "      <td>Hoffman</td>\n",
       "      <td>36</td>\n",
       "      <td>Las Vegas-Henderson-Paradise, NV MSA</td>\n",
       "      <td>2018-10-21</td>\n",
       "      <td>surf</td>\n",
       "      <td>NaT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1003</td>\n",
       "      <td>Reynaldo</td>\n",
       "      <td>Jenkins</td>\n",
       "      <td>52</td>\n",
       "      <td>Tulsa, OK MSA</td>\n",
       "      <td>2018-01-28</td>\n",
       "      <td>surf</td>\n",
       "      <td>NaT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1004</td>\n",
       "      <td>Leonila</td>\n",
       "      <td>Thompson</td>\n",
       "      <td>40</td>\n",
       "      <td>Seattle-Tacoma-Bellevue, WA MSA</td>\n",
       "      <td>2018-05-23</td>\n",
       "      <td>surf</td>\n",
       "      <td>NaT</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   user_id first_name  last_name  age                                   city  \\\n",
       "0     1000   Anamaria      Bauer   45  Atlanta-Sandy Springs-Roswell, GA MSA   \n",
       "1     1001     Mickey  Wilkerson   28        Seattle-Tacoma-Bellevue, WA MSA   \n",
       "2     1002     Carlee    Hoffman   36   Las Vegas-Henderson-Paradise, NV MSA   \n",
       "3     1003   Reynaldo    Jenkins   52                          Tulsa, OK MSA   \n",
       "4     1004    Leonila   Thompson   40        Seattle-Tacoma-Bellevue, WA MSA   \n",
       "\n",
       "    reg_date      plan churn_date  \n",
       "0 2018-12-24  ultimate        NaT  \n",
       "1 2018-08-13      surf        NaT  \n",
       "2 2018-10-21      surf        NaT  \n",
       "3 2018-01-28      surf        NaT  \n",
       "4 2018-05-23      surf        NaT  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "users['reg_date'] = pd.to_datetime(users['reg_date'], format = '%Y-%m-%d')\n",
    "users['churn_date'] = pd.to_datetime(users['churn_date'], format = '%Y-%m-%d')\n",
    "print(users.info())\n",
    "display(users.head())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now that the date is fixed. I am going to take a closer look at the cities. First by using unique():"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['Albany-Schenectady-Troy, NY MSA' 'Albuquerque, NM MSA'\n",
      " 'Atlanta-Sandy Springs-Roswell, GA MSA'\n",
      " 'Austin-Round Rock-Georgetown, TX MSA' 'Bakersfield, CA MSA'\n",
      " 'Baltimore-Columbia-Towson, MD MSA' 'Baton Rouge, LA MSA'\n",
      " 'Birmingham-Hoover, AL MSA' 'Boston-Cambridge-Newton, MA-NH MSA'\n",
      " 'Bridgeport-Stamford-Norwalk, CT MSA' 'Buffalo-Cheektowaga, NY MSA'\n",
      " 'Cape Coral-Fort Myers, FL MSA' 'Charleston-North Charleston, SC MSA'\n",
      " 'Charlotte-Concord-Gastonia, NC-SC MSA'\n",
      " 'Chicago-Naperville-Elgin, IL-IN-WI MSA' 'Cincinnati, OH-KY-IN MSA'\n",
      " 'Cleveland-Elyria, OH MSA' 'Colorado Springs, CO MSA' 'Columbia, SC MSA'\n",
      " 'Columbus, OH MSA' 'Dallas-Fort Worth-Arlington, TX MSA'\n",
      " 'Dayton-Kettering, OH MSA' 'Denver-Aurora-Lakewood, CO MSA'\n",
      " 'Detroit-Warren-Dearborn, MI MSA' 'El Paso, TX MSA' 'Fresno, CA MSA'\n",
      " 'Grand Rapids-Kentwood, MI MSA' 'Greensboro-High Point, NC MSA'\n",
      " 'Houston-The Woodlands-Sugar Land, TX MSA'\n",
      " 'Indianapolis-Carmel-Anderson, IN MSA' 'Jacksonville, FL MSA'\n",
      " 'Kansas City, MO-KS MSA' 'Knoxville, TN MSA'\n",
      " 'Las Vegas-Henderson-Paradise, NV MSA'\n",
      " 'Los Angeles-Long Beach-Anaheim, CA MSA'\n",
      " 'Louisville/Jefferson County, KY-IN MSA' 'Memphis, TN-MS-AR MSA'\n",
      " 'Miami-Fort Lauderdale-West Palm Beach, FL MSA'\n",
      " 'Milwaukee-Waukesha, WI MSA'\n",
      " 'Minneapolis-St. Paul-Bloomington, MN-WI MSA'\n",
      " 'Nashville-Davidson–Murfreesboro–Franklin, TN MSA'\n",
      " 'New Haven-Milford, CT MSA' 'New Orleans-Metairie, LA MSA'\n",
      " 'New York-Newark-Jersey City, NY-NJ-PA MSA'\n",
      " 'North Port-Sarasota-Bradenton, FL MSA' 'Oklahoma City, OK MSA'\n",
      " 'Omaha-Council Bluffs, NE-IA MSA' 'Orlando-Kissimmee-Sanford, FL MSA'\n",
      " 'Oxnard-Thousand Oaks-Ventura, CA MSA'\n",
      " 'Philadelphia-Camden-Wilmington, PA-NJ-DE-MD MSA'\n",
      " 'Phoenix-Mesa-Chandler, AZ MSA' 'Pittsburgh, PA MSA'\n",
      " 'Portland-Vancouver-Hillsboro, OR-WA MSA' 'Providence-Warwick, RI-MA MSA'\n",
      " 'Raleigh-Cary, NC MSA' 'Richmond, VA MSA'\n",
      " 'Riverside-San Bernardino-Ontario, CA MSA' 'Rochester, NY MSA'\n",
      " 'Sacramento–Roseville–Folsom, CA MSA' 'Salt Lake City, UT MSA'\n",
      " 'San Antonio-New Braunfels, TX MSA'\n",
      " 'San Diego-Chula Vista-Carlsbad, CA MSA'\n",
      " 'San Francisco-Oakland-Berkeley, CA MSA'\n",
      " 'San Jose-Sunnyvale-Santa Clara, CA MSA'\n",
      " 'Seattle-Tacoma-Bellevue, WA MSA' 'St. Louis, MO-IL MSA'\n",
      " 'Stockton, CA MSA' 'Tampa-St. Petersburg-Clearwater, FL MSA'\n",
      " 'Tucson, AZ MSA' 'Tulsa, OK MSA' 'Urban Honolulu, HI MSA'\n",
      " 'Virginia Beach-Norfolk-Newport News, VA-NC MSA'\n",
      " 'Washington-Arlington-Alexandria, DC-VA-MD-WV MSA']\n"
     ]
    }
   ],
   "source": [
    "print(users['city'].sort_values().unique())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The column name of 'city' is not representative of the data so I will change the name to 'region'. All of the cities are seperated from states by a comma, so I can use that to add new columns for state and city. I will also fix the spelling of 'USA'. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>first_name</th>\n",
       "      <th>last_name</th>\n",
       "      <th>age</th>\n",
       "      <th>region</th>\n",
       "      <th>reg_date</th>\n",
       "      <th>plan</th>\n",
       "      <th>churn_date</th>\n",
       "      <th>city</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1000</td>\n",
       "      <td>Anamaria</td>\n",
       "      <td>Bauer</td>\n",
       "      <td>45</td>\n",
       "      <td>Atlanta-Sandy Springs-Roswell, GA USA</td>\n",
       "      <td>2018-12-24</td>\n",
       "      <td>ultimate</td>\n",
       "      <td>NaT</td>\n",
       "      <td>Atlanta-Sandy Springs-Roswell</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1001</td>\n",
       "      <td>Mickey</td>\n",
       "      <td>Wilkerson</td>\n",
       "      <td>28</td>\n",
       "      <td>Seattle-Tacoma-Bellevue, WA USA</td>\n",
       "      <td>2018-08-13</td>\n",
       "      <td>surf</td>\n",
       "      <td>NaT</td>\n",
       "      <td>Seattle-Tacoma-Bellevue</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1002</td>\n",
       "      <td>Carlee</td>\n",
       "      <td>Hoffman</td>\n",
       "      <td>36</td>\n",
       "      <td>Las Vegas-Henderson-Paradise, NV USA</td>\n",
       "      <td>2018-10-21</td>\n",
       "      <td>surf</td>\n",
       "      <td>NaT</td>\n",
       "      <td>Las Vegas-Henderson-Paradise</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1003</td>\n",
       "      <td>Reynaldo</td>\n",
       "      <td>Jenkins</td>\n",
       "      <td>52</td>\n",
       "      <td>Tulsa, OK USA</td>\n",
       "      <td>2018-01-28</td>\n",
       "      <td>surf</td>\n",
       "      <td>NaT</td>\n",
       "      <td>Tulsa</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1004</td>\n",
       "      <td>Leonila</td>\n",
       "      <td>Thompson</td>\n",
       "      <td>40</td>\n",
       "      <td>Seattle-Tacoma-Bellevue, WA USA</td>\n",
       "      <td>2018-05-23</td>\n",
       "      <td>surf</td>\n",
       "      <td>NaT</td>\n",
       "      <td>Seattle-Tacoma-Bellevue</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   user_id first_name  last_name  age                                 region  \\\n",
       "0     1000   Anamaria      Bauer   45  Atlanta-Sandy Springs-Roswell, GA USA   \n",
       "1     1001     Mickey  Wilkerson   28        Seattle-Tacoma-Bellevue, WA USA   \n",
       "2     1002     Carlee    Hoffman   36   Las Vegas-Henderson-Paradise, NV USA   \n",
       "3     1003   Reynaldo    Jenkins   52                          Tulsa, OK USA   \n",
       "4     1004    Leonila   Thompson   40        Seattle-Tacoma-Bellevue, WA USA   \n",
       "\n",
       "    reg_date      plan churn_date                           city  \n",
       "0 2018-12-24  ultimate        NaT  Atlanta-Sandy Springs-Roswell  \n",
       "1 2018-08-13      surf        NaT        Seattle-Tacoma-Bellevue  \n",
       "2 2018-10-21      surf        NaT   Las Vegas-Henderson-Paradise  \n",
       "3 2018-01-28      surf        NaT                          Tulsa  \n",
       "4 2018-05-23      surf        NaT        Seattle-Tacoma-Bellevue  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "users.rename(columns = {'city': 'region'}, inplace = True)\n",
    "users['region'] = [sub.replace('MSA', 'USA') for sub in users['region']]\n",
    "city = []\n",
    "state_country = []\n",
    "for row in users['region']:\n",
    "    add_city = row.split(',')\n",
    "    city.append(add_city[0])\n",
    "    state_country.append(add_city[1])\n",
    "users['city'] = city\n",
    "display(users.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>first_name</th>\n",
       "      <th>last_name</th>\n",
       "      <th>age</th>\n",
       "      <th>region</th>\n",
       "      <th>reg_date</th>\n",
       "      <th>plan</th>\n",
       "      <th>churn_date</th>\n",
       "      <th>city</th>\n",
       "      <th>state</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1000</td>\n",
       "      <td>Anamaria</td>\n",
       "      <td>Bauer</td>\n",
       "      <td>45</td>\n",
       "      <td>Atlanta-Sandy Springs-Roswell, GA USA</td>\n",
       "      <td>2018-12-24</td>\n",
       "      <td>ultimate</td>\n",
       "      <td>NaT</td>\n",
       "      <td>Atlanta-Sandy Springs-Roswell</td>\n",
       "      <td>GA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1001</td>\n",
       "      <td>Mickey</td>\n",
       "      <td>Wilkerson</td>\n",
       "      <td>28</td>\n",
       "      <td>Seattle-Tacoma-Bellevue, WA USA</td>\n",
       "      <td>2018-08-13</td>\n",
       "      <td>surf</td>\n",
       "      <td>NaT</td>\n",
       "      <td>Seattle-Tacoma-Bellevue</td>\n",
       "      <td>WA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1002</td>\n",
       "      <td>Carlee</td>\n",
       "      <td>Hoffman</td>\n",
       "      <td>36</td>\n",
       "      <td>Las Vegas-Henderson-Paradise, NV USA</td>\n",
       "      <td>2018-10-21</td>\n",
       "      <td>surf</td>\n",
       "      <td>NaT</td>\n",
       "      <td>Las Vegas-Henderson-Paradise</td>\n",
       "      <td>NV</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1003</td>\n",
       "      <td>Reynaldo</td>\n",
       "      <td>Jenkins</td>\n",
       "      <td>52</td>\n",
       "      <td>Tulsa, OK USA</td>\n",
       "      <td>2018-01-28</td>\n",
       "      <td>surf</td>\n",
       "      <td>NaT</td>\n",
       "      <td>Tulsa</td>\n",
       "      <td>OK</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1004</td>\n",
       "      <td>Leonila</td>\n",
       "      <td>Thompson</td>\n",
       "      <td>40</td>\n",
       "      <td>Seattle-Tacoma-Bellevue, WA USA</td>\n",
       "      <td>2018-05-23</td>\n",
       "      <td>surf</td>\n",
       "      <td>NaT</td>\n",
       "      <td>Seattle-Tacoma-Bellevue</td>\n",
       "      <td>WA</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   user_id first_name  last_name  age                                 region  \\\n",
       "0     1000   Anamaria      Bauer   45  Atlanta-Sandy Springs-Roswell, GA USA   \n",
       "1     1001     Mickey  Wilkerson   28        Seattle-Tacoma-Bellevue, WA USA   \n",
       "2     1002     Carlee    Hoffman   36   Las Vegas-Henderson-Paradise, NV USA   \n",
       "3     1003   Reynaldo    Jenkins   52                          Tulsa, OK USA   \n",
       "4     1004    Leonila   Thompson   40        Seattle-Tacoma-Bellevue, WA USA   \n",
       "\n",
       "    reg_date      plan churn_date                           city state  \n",
       "0 2018-12-24  ultimate        NaT  Atlanta-Sandy Springs-Roswell    GA  \n",
       "1 2018-08-13      surf        NaT        Seattle-Tacoma-Bellevue    WA  \n",
       "2 2018-10-21      surf        NaT   Las Vegas-Henderson-Paradise    NV  \n",
       "3 2018-01-28      surf        NaT                          Tulsa    OK  \n",
       "4 2018-05-23      surf        NaT        Seattle-Tacoma-Bellevue    WA  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "state = []\n",
    "for item in state_country:\n",
    "    add_state = item.split(' ')\n",
    "    state.append(add_state[1])\n",
    "users['state'] = state\n",
    "display(users.head())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Enrich Data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "Here I am going to check the percentage of each plan. If the sample contains an equal or close to equal amount of people for each plan it will be easier to compare the plans. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ultimate:  32.2\n",
      "surf:  67.80000000000001\n"
     ]
    }
   ],
   "source": [
    "per_ultimate = users[users['plan'] == 'ultimate']['plan'].count() / 500 *100\n",
    "per_surf = users[users['plan'] == 'surf']['plan'].count() /500 *100\n",
    "print('ultimate: ', per_ultimate)\n",
    "print('surf: ', per_surf)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The ultimate plan only accounts for one-third of the sample. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Calls"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 137735 entries, 0 to 137734\n",
      "Data columns (total 4 columns):\n",
      " #   Column     Non-Null Count   Dtype  \n",
      "---  ------     --------------   -----  \n",
      " 0   id         137735 non-null  object \n",
      " 1   user_id    137735 non-null  int64  \n",
      " 2   call_date  137735 non-null  object \n",
      " 3   duration   137735 non-null  float64\n",
      "dtypes: float64(1), int64(1), object(2)\n",
      "memory usage: 4.2+ MB\n",
      "None\n"
     ]
    }
   ],
   "source": [
    "# Print the general/summary information about the calls' DataFrame\n",
    "print(calls.info())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>user_id</th>\n",
       "      <th>call_date</th>\n",
       "      <th>duration</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>26456</th>\n",
       "      <td>1100_13</td>\n",
       "      <td>1100</td>\n",
       "      <td>2018-12-20</td>\n",
       "      <td>4.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>133352</th>\n",
       "      <td>1483_149</td>\n",
       "      <td>1483</td>\n",
       "      <td>2018-06-26</td>\n",
       "      <td>8.27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>87949</th>\n",
       "      <td>1322_57</td>\n",
       "      <td>1322</td>\n",
       "      <td>2018-08-28</td>\n",
       "      <td>7.68</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30919</th>\n",
       "      <td>1115_553</td>\n",
       "      <td>1115</td>\n",
       "      <td>2018-12-12</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>111703</th>\n",
       "      <td>1392_113</td>\n",
       "      <td>1392</td>\n",
       "      <td>2018-11-11</td>\n",
       "      <td>5.69</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id  user_id   call_date  duration\n",
       "26456    1100_13     1100  2018-12-20      4.30\n",
       "133352  1483_149     1483  2018-06-26      8.27\n",
       "87949    1322_57     1322  2018-08-28      7.68\n",
       "30919   1115_553     1115  2018-12-12      0.00\n",
       "111703  1392_113     1392  2018-11-11      5.69"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Print a sample of data for calls\n",
    "display(calls.sample(5))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "Again I will change the call_date to datetime datatype. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Fix data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>user_id</th>\n",
       "      <th>call_date</th>\n",
       "      <th>duration</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1000_93</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-27</td>\n",
       "      <td>8.52</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1000_145</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-27</td>\n",
       "      <td>13.66</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1000_247</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-27</td>\n",
       "      <td>14.48</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1000_309</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-28</td>\n",
       "      <td>5.76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1000_380</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-30</td>\n",
       "      <td>4.22</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         id  user_id  call_date  duration\n",
       "0   1000_93     1000 2018-12-27      8.52\n",
       "1  1000_145     1000 2018-12-27     13.66\n",
       "2  1000_247     1000 2018-12-27     14.48\n",
       "3  1000_309     1000 2018-12-28      5.76\n",
       "4  1000_380     1000 2018-12-30      4.22"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 137735 entries, 0 to 137734\n",
      "Data columns (total 4 columns):\n",
      " #   Column     Non-Null Count   Dtype         \n",
      "---  ------     --------------   -----         \n",
      " 0   id         137735 non-null  object        \n",
      " 1   user_id    137735 non-null  int64         \n",
      " 2   call_date  137735 non-null  datetime64[ns]\n",
      " 3   duration   137735 non-null  float64       \n",
      "dtypes: datetime64[ns](1), float64(1), int64(1), object(1)\n",
      "memory usage: 4.2+ MB\n",
      "None\n"
     ]
    }
   ],
   "source": [
    "calls['call_date'] = pd.to_datetime(calls['call_date'], format = '%Y-%m-%d')\n",
    "display(calls.head())\n",
    "print(calls.info())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Enrich data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "I will need to know the total minutes each customer has per month. First I will create a new column and extract the month from the call_date. Then I can use the groupby() method to get the total minutes of the calls per customer per month. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>user_id</th>\n",
       "      <th>call_date</th>\n",
       "      <th>duration</th>\n",
       "      <th>month</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1000_93</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-27</td>\n",
       "      <td>8.52</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1000_145</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-27</td>\n",
       "      <td>13.66</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1000_247</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-27</td>\n",
       "      <td>14.48</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1000_309</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-28</td>\n",
       "      <td>5.76</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1000_380</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-30</td>\n",
       "      <td>4.22</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         id  user_id  call_date  duration  month\n",
       "0   1000_93     1000 2018-12-27      8.52     12\n",
       "1  1000_145     1000 2018-12-27     13.66     12\n",
       "2  1000_247     1000 2018-12-27     14.48     12\n",
       "3  1000_309     1000 2018-12-28      5.76     12\n",
       "4  1000_380     1000 2018-12-30      4.22     12"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "calls['month'] = calls['call_date'].dt.month\n",
    "display(calls.head())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Messages"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 76051 entries, 0 to 76050\n",
      "Data columns (total 3 columns):\n",
      " #   Column        Non-Null Count  Dtype \n",
      "---  ------        --------------  ----- \n",
      " 0   id            76051 non-null  object\n",
      " 1   user_id       76051 non-null  int64 \n",
      " 2   message_date  76051 non-null  object\n",
      "dtypes: int64(1), object(2)\n",
      "memory usage: 1.7+ MB\n",
      "None\n"
     ]
    }
   ],
   "source": [
    "# Print the general/summary information about the messages' DataFrame\n",
    "print(messages.info())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>user_id</th>\n",
       "      <th>message_date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>9510</th>\n",
       "      <td>1069_631</td>\n",
       "      <td>1069</td>\n",
       "      <td>2018-11-09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53139</th>\n",
       "      <td>1339_273</td>\n",
       "      <td>1339</td>\n",
       "      <td>2018-09-30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46279</th>\n",
       "      <td>1316_88</td>\n",
       "      <td>1316</td>\n",
       "      <td>2018-09-21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58947</th>\n",
       "      <td>1374_121</td>\n",
       "      <td>1374</td>\n",
       "      <td>2018-06-18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66442</th>\n",
       "      <td>1433_382</td>\n",
       "      <td>1433</td>\n",
       "      <td>2018-12-25</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "             id  user_id message_date\n",
       "9510   1069_631     1069   2018-11-09\n",
       "53139  1339_273     1339   2018-09-30\n",
       "46279   1316_88     1316   2018-09-21\n",
       "58947  1374_121     1374   2018-06-18\n",
       "66442  1433_382     1433   2018-12-25"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Print a sample of data for messages\n",
    "display(messages.sample(5))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "I will change message_date to datetime datatype. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Fix data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 76051 entries, 0 to 76050\n",
      "Data columns (total 3 columns):\n",
      " #   Column        Non-Null Count  Dtype         \n",
      "---  ------        --------------  -----         \n",
      " 0   id            76051 non-null  object        \n",
      " 1   user_id       76051 non-null  int64         \n",
      " 2   message_date  76051 non-null  datetime64[ns]\n",
      "dtypes: datetime64[ns](1), int64(1), object(1)\n",
      "memory usage: 1.7+ MB\n",
      "None\n",
      "         id  user_id message_date\n",
      "0  1000_125     1000   2018-12-27\n",
      "1  1000_160     1000   2018-12-31\n",
      "2  1000_223     1000   2018-12-31\n",
      "3  1000_251     1000   2018-12-27\n",
      "4  1000_255     1000   2018-12-26\n"
     ]
    }
   ],
   "source": [
    "messages['message_date'] = pd.to_datetime(messages['message_date'], format = '%Y-%m-%d')\n",
    "print(messages.info())\n",
    "print(messages.head())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Enrich data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "I will need to know how many messages each customer sends per month. I will add a month column, then group by user_id and month. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>user_id</th>\n",
       "      <th>message_date</th>\n",
       "      <th>month</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1000_125</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-27</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1000_160</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-31</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1000_223</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-31</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1000_251</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-27</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1000_255</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-26</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>76001</th>\n",
       "      <td>1497_3</td>\n",
       "      <td>1497</td>\n",
       "      <td>2018-12-25</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>76002</th>\n",
       "      <td>1497_32</td>\n",
       "      <td>1497</td>\n",
       "      <td>2018-12-14</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>76003</th>\n",
       "      <td>1497_45</td>\n",
       "      <td>1497</td>\n",
       "      <td>2018-12-11</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>76004</th>\n",
       "      <td>1497_47</td>\n",
       "      <td>1497</td>\n",
       "      <td>2018-12-19</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>76005</th>\n",
       "      <td>1497_53</td>\n",
       "      <td>1497</td>\n",
       "      <td>2018-12-29</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8737 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             id  user_id message_date  month\n",
       "0      1000_125     1000   2018-12-27     12\n",
       "1      1000_160     1000   2018-12-31     12\n",
       "2      1000_223     1000   2018-12-31     12\n",
       "3      1000_251     1000   2018-12-27     12\n",
       "4      1000_255     1000   2018-12-26     12\n",
       "...         ...      ...          ...    ...\n",
       "76001    1497_3     1497   2018-12-25     12\n",
       "76002   1497_32     1497   2018-12-14     12\n",
       "76003   1497_45     1497   2018-12-11     12\n",
       "76004   1497_47     1497   2018-12-19     12\n",
       "76005   1497_53     1497   2018-12-29     12\n",
       "\n",
       "[8737 rows x 4 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "messages['month'] = messages['message_date'].dt.month\n",
    "messages_per_month = messages.groupby(['user_id', 'month'])\n",
    "display(messages_per_month.head())\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Internet"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 104825 entries, 0 to 104824\n",
      "Data columns (total 4 columns):\n",
      " #   Column        Non-Null Count   Dtype  \n",
      "---  ------        --------------   -----  \n",
      " 0   id            104825 non-null  object \n",
      " 1   user_id       104825 non-null  int64  \n",
      " 2   session_date  104825 non-null  object \n",
      " 3   mb_used       104825 non-null  float64\n",
      "dtypes: float64(1), int64(1), object(2)\n",
      "memory usage: 3.2+ MB\n",
      "None\n"
     ]
    }
   ],
   "source": [
    "# Print the general/summary information about the internet DataFrame\n",
    "print(internet.info())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>user_id</th>\n",
       "      <th>session_date</th>\n",
       "      <th>mb_used</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>42268</th>\n",
       "      <td>1187_445</td>\n",
       "      <td>1187</td>\n",
       "      <td>2018-06-15</td>\n",
       "      <td>400.70</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>71718</th>\n",
       "      <td>1334_286</td>\n",
       "      <td>1334</td>\n",
       "      <td>2018-08-20</td>\n",
       "      <td>660.91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>103612</th>\n",
       "      <td>1495_235</td>\n",
       "      <td>1495</td>\n",
       "      <td>2018-12-30</td>\n",
       "      <td>378.88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12133</th>\n",
       "      <td>1059_241</td>\n",
       "      <td>1059</td>\n",
       "      <td>2018-06-10</td>\n",
       "      <td>8.34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>60600</th>\n",
       "      <td>1276_84</td>\n",
       "      <td>1276</td>\n",
       "      <td>2018-12-18</td>\n",
       "      <td>104.53</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id  user_id session_date  mb_used\n",
       "42268   1187_445     1187   2018-06-15   400.70\n",
       "71718   1334_286     1334   2018-08-20   660.91\n",
       "103612  1495_235     1495   2018-12-30   378.88\n",
       "12133   1059_241     1059   2018-06-10     8.34\n",
       "60600    1276_84     1276   2018-12-18   104.53"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Print a sample of data for the internet traffic\n",
    "display(internet.sample(5))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "I will change the session datatype from object to datetime. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Fix data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 104825 entries, 0 to 104824\n",
      "Data columns (total 4 columns):\n",
      " #   Column        Non-Null Count   Dtype         \n",
      "---  ------        --------------   -----         \n",
      " 0   id            104825 non-null  object        \n",
      " 1   user_id       104825 non-null  int64         \n",
      " 2   session_date  104825 non-null  datetime64[ns]\n",
      " 3   mb_used       104825 non-null  float64       \n",
      "dtypes: datetime64[ns](1), float64(1), int64(1), object(1)\n",
      "memory usage: 3.2+ MB\n",
      "None\n"
     ]
    }
   ],
   "source": [
    "internet['session_date'] = pd.to_datetime(internet['session_date'], format = '%Y-%m-%d')\n",
    "print(internet.info())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Enrich data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "I will need to know how much internet is used by each customer per month. I will also add a new column for gb used each month. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>user_id</th>\n",
       "      <th>session_date</th>\n",
       "      <th>mb_used</th>\n",
       "      <th>month</th>\n",
       "      <th>gb_used</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1000_13</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-29</td>\n",
       "      <td>89.86</td>\n",
       "      <td>12</td>\n",
       "      <td>0.087754</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1000_204</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-31</td>\n",
       "      <td>0.00</td>\n",
       "      <td>12</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1000_379</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-28</td>\n",
       "      <td>660.40</td>\n",
       "      <td>12</td>\n",
       "      <td>0.644922</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1000_413</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-26</td>\n",
       "      <td>270.99</td>\n",
       "      <td>12</td>\n",
       "      <td>0.264639</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1000_442</td>\n",
       "      <td>1000</td>\n",
       "      <td>2018-12-27</td>\n",
       "      <td>880.22</td>\n",
       "      <td>12</td>\n",
       "      <td>0.859590</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         id  user_id session_date  mb_used  month   gb_used\n",
       "0   1000_13     1000   2018-12-29    89.86     12  0.087754\n",
       "1  1000_204     1000   2018-12-31     0.00     12  0.000000\n",
       "2  1000_379     1000   2018-12-28   660.40     12  0.644922\n",
       "3  1000_413     1000   2018-12-26   270.99     12  0.264639\n",
       "4  1000_442     1000   2018-12-27   880.22     12  0.859590"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "internet['month'] = internet['session_date'].dt.month\n",
    "internet_per_month = internet.groupby(['user_id', 'month'])\n",
    "\n",
    "internet['gb_used'] = internet['mb_used']/1024\n",
    "display(internet.head())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Study plan conditions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>messages_included</th>\n",
       "      <th>mb_per_month_included</th>\n",
       "      <th>minutes_included</th>\n",
       "      <th>usd_monthly_pay</th>\n",
       "      <th>usd_per_gb</th>\n",
       "      <th>usd_per_message</th>\n",
       "      <th>usd_per_minute</th>\n",
       "      <th>plan_name</th>\n",
       "      <th>gb_per_month_included</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>50</td>\n",
       "      <td>15360</td>\n",
       "      <td>500</td>\n",
       "      <td>20</td>\n",
       "      <td>10</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.03</td>\n",
       "      <td>surf</td>\n",
       "      <td>15.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1000</td>\n",
       "      <td>30720</td>\n",
       "      <td>3000</td>\n",
       "      <td>70</td>\n",
       "      <td>7</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.01</td>\n",
       "      <td>ultimate</td>\n",
       "      <td>30.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   messages_included  mb_per_month_included  minutes_included  \\\n",
       "0                 50                  15360               500   \n",
       "1               1000                  30720              3000   \n",
       "\n",
       "   usd_monthly_pay  usd_per_gb  usd_per_message  usd_per_minute plan_name  \\\n",
       "0               20          10             0.03            0.03      surf   \n",
       "1               70           7             0.01            0.01  ultimate   \n",
       "\n",
       "   gb_per_month_included  \n",
       "0                   15.0  \n",
       "1                   30.0  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Print out the plan conditions and make sure they are clear for you\n",
    "display(plans)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Aggregate data per user\n",
    "\n",
    "[Now, as the data is clean, aggregate data per user per period in order to have just one record per user per period. It should ease the further analysis a lot.]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 80,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "               call_date\n",
      "user_id month           \n",
      "1000    12            16\n",
      "1001    8             27\n",
      "        9             49\n",
      "        10            65\n",
      "        11            64\n"
     ]
    }
   ],
   "source": [
    "# Calculate the number of calls made by each user per month. Save the result.\n",
    "\n",
    "minutes_per_month = calls.groupby(['user_id', 'month'])\n",
    "calls_count = minutes_per_month.agg({'call_date': 'count'})\n",
    "print(calls_count.head())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 81,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "               duration\n",
      "user_id month          \n",
      "1000    12       116.83\n",
      "1001    8        171.14\n",
      "        9        297.69\n",
      "        10       374.11\n",
      "        11       404.59\n",
      "               duration\n",
      "user_id month          \n",
      "1000    12     7.301875\n",
      "1001    8      6.338519\n",
      "        9      6.075306\n",
      "        10     5.755538\n",
      "        11     6.321719\n"
     ]
    }
   ],
   "source": [
    "# Calculate the amount of minutes spent by each user per month. Save the result.\n",
    "minutes_total = minutes_per_month.agg({'duration': 'sum'})\n",
    "avg_duration =  minutes_per_month.agg({'duration': 'mean'})\n",
    "print(minutes_total.head())\n",
    "print(avg_duration.head())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 82,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "               id\n",
      "user_id month    \n",
      "1000    12     11\n",
      "1001    8      30\n",
      "        9      44\n",
      "        10     53\n",
      "        11     36\n"
     ]
    }
   ],
   "source": [
    "# Calculate the number of messages sent by each user per month. Save the result.\n",
    "total_messages = messages_per_month.agg({'id': 'count'})\n",
    "print(total_messages.head())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                 gb_used\n",
      "user_id month           \n",
      "1000    12      1.856904\n",
      "1001    8       6.756982\n",
      "        9      13.002754\n",
      "        10     21.807119\n",
      "        11     18.070605\n"
     ]
    }
   ],
   "source": [
    "# Calculate the volume of internet traffic used by each user per month. Save the result.\n",
    "total_internet = internet_per_month.agg({'gb_used': 'sum'})\n",
    "print(total_internet.head())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Merging the data from the aggregate functions will give a table of how each user is using their plan each month. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 84,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "MultiIndex: 2293 entries, (1000, 12) to (1499, 12)\n",
      "Data columns (total 5 columns):\n",
      " #   Column        Non-Null Count  Dtype  \n",
      "---  ------        --------------  -----  \n",
      " 0   call_date     2258 non-null   float64\n",
      " 1   duration      2258 non-null   float64\n",
      " 2   id            1806 non-null   float64\n",
      " 3   gb_used       2277 non-null   float64\n",
      " 4   avg_duration  2258 non-null   float64\n",
      "dtypes: float64(5)\n",
      "memory usage: 116.8 KB\n",
      "None\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>call_date</th>\n",
       "      <th>duration</th>\n",
       "      <th>id</th>\n",
       "      <th>gb_used</th>\n",
       "      <th>avg_duration</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>user_id</th>\n",
       "      <th>month</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1000</th>\n",
       "      <th>12</th>\n",
       "      <td>16.0</td>\n",
       "      <td>116.83</td>\n",
       "      <td>11.0</td>\n",
       "      <td>1.856904</td>\n",
       "      <td>7.301875</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"4\" valign=\"top\">1001</th>\n",
       "      <th>8</th>\n",
       "      <td>27.0</td>\n",
       "      <td>171.14</td>\n",
       "      <td>30.0</td>\n",
       "      <td>6.756982</td>\n",
       "      <td>6.338519</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>49.0</td>\n",
       "      <td>297.69</td>\n",
       "      <td>44.0</td>\n",
       "      <td>13.002754</td>\n",
       "      <td>6.075306</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>65.0</td>\n",
       "      <td>374.11</td>\n",
       "      <td>53.0</td>\n",
       "      <td>21.807119</td>\n",
       "      <td>5.755538</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>64.0</td>\n",
       "      <td>404.59</td>\n",
       "      <td>36.0</td>\n",
       "      <td>18.070605</td>\n",
       "      <td>6.321719</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               call_date  duration    id    gb_used  avg_duration\n",
       "user_id month                                                    \n",
       "1000    12          16.0    116.83  11.0   1.856904      7.301875\n",
       "1001    8           27.0    171.14  30.0   6.756982      6.338519\n",
       "        9           49.0    297.69  44.0  13.002754      6.075306\n",
       "        10          65.0    374.11  53.0  21.807119      5.755538\n",
       "        11          64.0    404.59  36.0  18.070605      6.321719"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Merge the data for calls, minutes, messages, internet based on user_id and month\n",
    "user_per_month = pd.concat([calls_count, minutes_total, total_messages, total_internet], axis = 1)\n",
    "user_per_month['avg_duration'] = avg_duration\n",
    "\n",
    "print(user_per_month.info())\n",
    "display(user_per_month.head())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 85,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "    user_id first_name last_name  age                                  region  \\\n",
      "0      1000   Anamaria     Bauer   45   Atlanta-Sandy Springs-Roswell, GA USA   \n",
      "6      1006     Jesusa  Bradford   73  San Francisco-Oakland-Berkeley, CA USA   \n",
      "8      1008      Emely   Hoffman   53       Orlando-Kissimmee-Sanford, FL USA   \n",
      "11     1011     Halina     Henry   73                Cleveland-Elyria, OH USA   \n",
      "13     1013    Nicolas    Snider   50                       Knoxville, TN USA   \n",
      "\n",
      "     reg_date      plan churn_date                            city state  \n",
      "0  2018-12-24  ultimate        NaT   Atlanta-Sandy Springs-Roswell    GA  \n",
      "6  2018-11-27  ultimate 2018-12-18  San Francisco-Oakland-Berkeley    CA  \n",
      "8  2018-08-03  ultimate        NaT       Orlando-Kissimmee-Sanford    FL  \n",
      "11 2018-01-18  ultimate        NaT                Cleveland-Elyria    OH  \n",
      "13 2018-12-01  ultimate        NaT                       Knoxville    TN  \n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>call_count</th>\n",
       "      <th>total_minutes</th>\n",
       "      <th>message_count</th>\n",
       "      <th>gb_used</th>\n",
       "      <th>avg_duration</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>user_id</th>\n",
       "      <th>month</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1000</th>\n",
       "      <th>12</th>\n",
       "      <td>16.0</td>\n",
       "      <td>116.83</td>\n",
       "      <td>11.0</td>\n",
       "      <td>1.856904</td>\n",
       "      <td>7.301875</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">1006</th>\n",
       "      <th>11</th>\n",
       "      <td>2.0</td>\n",
       "      <td>9.32</td>\n",
       "      <td>15.0</td>\n",
       "      <td>2.019893</td>\n",
       "      <td>4.660000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>9.0</td>\n",
       "      <td>54.79</td>\n",
       "      <td>139.0</td>\n",
       "      <td>31.366035</td>\n",
       "      <td>6.087778</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">1008</th>\n",
       "      <th>10</th>\n",
       "      <td>71.0</td>\n",
       "      <td>450.21</td>\n",
       "      <td>21.0</td>\n",
       "      <td>16.706045</td>\n",
       "      <td>6.340986</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>63.0</td>\n",
       "      <td>422.81</td>\n",
       "      <td>37.0</td>\n",
       "      <td>23.121797</td>\n",
       "      <td>6.711270</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               call_count  total_minutes  message_count    gb_used  \\\n",
       "user_id month                                                        \n",
       "1000    12           16.0         116.83           11.0   1.856904   \n",
       "1006    11            2.0           9.32           15.0   2.019893   \n",
       "        12            9.0          54.79          139.0  31.366035   \n",
       "1008    10           71.0         450.21           21.0  16.706045   \n",
       "        11           63.0         422.81           37.0  23.121797   \n",
       "\n",
       "               avg_duration  \n",
       "user_id month                \n",
       "1000    12         7.301875  \n",
       "1006    11         4.660000  \n",
       "        12         6.087778  \n",
       "1008    10         6.340986  \n",
       "        11         6.711270  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>call_count</th>\n",
       "      <th>total_minutes</th>\n",
       "      <th>message_count</th>\n",
       "      <th>gb_used</th>\n",
       "      <th>avg_duration</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>user_id</th>\n",
       "      <th>month</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">1001</th>\n",
       "      <th>8</th>\n",
       "      <td>27.0</td>\n",
       "      <td>171.14</td>\n",
       "      <td>30.0</td>\n",
       "      <td>6.756982</td>\n",
       "      <td>6.338519</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>49.0</td>\n",
       "      <td>297.69</td>\n",
       "      <td>44.0</td>\n",
       "      <td>13.002754</td>\n",
       "      <td>6.075306</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>65.0</td>\n",
       "      <td>374.11</td>\n",
       "      <td>53.0</td>\n",
       "      <td>21.807119</td>\n",
       "      <td>5.755538</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>64.0</td>\n",
       "      <td>404.59</td>\n",
       "      <td>36.0</td>\n",
       "      <td>18.070605</td>\n",
       "      <td>6.321719</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>56.0</td>\n",
       "      <td>392.93</td>\n",
       "      <td>44.0</td>\n",
       "      <td>18.915215</td>\n",
       "      <td>7.016607</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               call_count  total_minutes  message_count    gb_used  \\\n",
       "user_id month                                                        \n",
       "1001    8            27.0         171.14           30.0   6.756982   \n",
       "        9            49.0         297.69           44.0  13.002754   \n",
       "        10           65.0         374.11           53.0  21.807119   \n",
       "        11           64.0         404.59           36.0  18.070605   \n",
       "        12           56.0         392.93           44.0  18.915215   \n",
       "\n",
       "               avg_duration  \n",
       "user_id month                \n",
       "1001    8          6.338519  \n",
       "        9          6.075306  \n",
       "        10         5.755538  \n",
       "        11         6.321719  \n",
       "        12         7.016607  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Add the plan information\n",
    "column_names = {'call_date': 'call_count', 'duration': 'total_minutes', 'id': 'message_count', 'mb_used': 'mb_used'}\n",
    "user_per_month = user_per_month.rename(columns = column_names)\n",
    "user_per_month_rows = user_per_month\n",
    "ultimate_plan = users[users['plan'] == 'ultimate']\n",
    "print(ultimate_plan.head())\n",
    "ultimate_users = user_per_month_rows.query('user_id in @ultimate_plan.user_id')\n",
    "surf_users = user_per_month_rows.query('user_id not in @ultimate_plan.user_id')\n",
    "display(ultimate_users.head())\n",
    "display(surf_users.head())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 86,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_59/405073534.py:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  ultimate_users['plan_cost'] = ult_cost\n",
      "/tmp/ipykernel_59/405073534.py:8: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  surf_users['plan_cost'] = surf_cost\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>call_count</th>\n",
       "      <th>total_minutes</th>\n",
       "      <th>message_count</th>\n",
       "      <th>gb_used</th>\n",
       "      <th>avg_duration</th>\n",
       "      <th>plan_cost</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>user_id</th>\n",
       "      <th>month</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1000</th>\n",
       "      <th>12</th>\n",
       "      <td>16.0</td>\n",
       "      <td>116.83</td>\n",
       "      <td>11.0</td>\n",
       "      <td>1.856904</td>\n",
       "      <td>7.301875</td>\n",
       "      <td>70</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">1006</th>\n",
       "      <th>11</th>\n",
       "      <td>2.0</td>\n",
       "      <td>9.32</td>\n",
       "      <td>15.0</td>\n",
       "      <td>2.019893</td>\n",
       "      <td>4.660000</td>\n",
       "      <td>70</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>9.0</td>\n",
       "      <td>54.79</td>\n",
       "      <td>139.0</td>\n",
       "      <td>31.366035</td>\n",
       "      <td>6.087778</td>\n",
       "      <td>70</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">1008</th>\n",
       "      <th>10</th>\n",
       "      <td>71.0</td>\n",
       "      <td>450.21</td>\n",
       "      <td>21.0</td>\n",
       "      <td>16.706045</td>\n",
       "      <td>6.340986</td>\n",
       "      <td>70</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>63.0</td>\n",
       "      <td>422.81</td>\n",
       "      <td>37.0</td>\n",
       "      <td>23.121797</td>\n",
       "      <td>6.711270</td>\n",
       "      <td>70</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               call_count  total_minutes  message_count    gb_used  \\\n",
       "user_id month                                                        \n",
       "1000    12           16.0         116.83           11.0   1.856904   \n",
       "1006    11            2.0           9.32           15.0   2.019893   \n",
       "        12            9.0          54.79          139.0  31.366035   \n",
       "1008    10           71.0         450.21           21.0  16.706045   \n",
       "        11           63.0         422.81           37.0  23.121797   \n",
       "\n",
       "               avg_duration  plan_cost  \n",
       "user_id month                           \n",
       "1000    12         7.301875         70  \n",
       "1006    11         4.660000         70  \n",
       "        12         6.087778         70  \n",
       "1008    10         6.340986         70  \n",
       "        11         6.711270         70  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>call_count</th>\n",
       "      <th>total_minutes</th>\n",
       "      <th>message_count</th>\n",
       "      <th>gb_used</th>\n",
       "      <th>avg_duration</th>\n",
       "      <th>plan_cost</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>user_id</th>\n",
       "      <th>month</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">1001</th>\n",
       "      <th>8</th>\n",
       "      <td>27.0</td>\n",
       "      <td>171.14</td>\n",
       "      <td>30.0</td>\n",
       "      <td>6.756982</td>\n",
       "      <td>6.338519</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>49.0</td>\n",
       "      <td>297.69</td>\n",
       "      <td>44.0</td>\n",
       "      <td>13.002754</td>\n",
       "      <td>6.075306</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>65.0</td>\n",
       "      <td>374.11</td>\n",
       "      <td>53.0</td>\n",
       "      <td>21.807119</td>\n",
       "      <td>5.755538</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>64.0</td>\n",
       "      <td>404.59</td>\n",
       "      <td>36.0</td>\n",
       "      <td>18.070605</td>\n",
       "      <td>6.321719</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>56.0</td>\n",
       "      <td>392.93</td>\n",
       "      <td>44.0</td>\n",
       "      <td>18.915215</td>\n",
       "      <td>7.016607</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               call_count  total_minutes  message_count    gb_used  \\\n",
       "user_id month                                                        \n",
       "1001    8            27.0         171.14           30.0   6.756982   \n",
       "        9            49.0         297.69           44.0  13.002754   \n",
       "        10           65.0         374.11           53.0  21.807119   \n",
       "        11           64.0         404.59           36.0  18.070605   \n",
       "        12           56.0         392.93           44.0  18.915215   \n",
       "\n",
       "               avg_duration  plan_cost  \n",
       "user_id month                           \n",
       "1001    8          6.338519         20  \n",
       "        9          6.075306         20  \n",
       "        10         5.755538         20  \n",
       "        11         6.321719         20  \n",
       "        12         7.016607         20  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "ult_cost = []\n",
    "for item in ultimate_users.index:\n",
    "    ult_cost.append(70)\n",
    "ultimate_users['plan_cost'] = ult_cost\n",
    "surf_cost = []\n",
    "for item in surf_users.index:\n",
    "    surf_cost.append(20)\n",
    "surf_users['plan_cost'] = surf_cost\n",
    "display(ultimate_users.head())\n",
    "display(surf_users.head())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_59/901298447.py:11: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  ultimate_users['minutes_revenue'] = minutes_revenue\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>call_count</th>\n",
       "      <th>total_minutes</th>\n",
       "      <th>message_count</th>\n",
       "      <th>gb_used</th>\n",
       "      <th>avg_duration</th>\n",
       "      <th>plan_cost</th>\n",
       "      <th>minutes_revenue</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>user_id</th>\n",
       "      <th>month</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1000</th>\n",
       "      <th>12</th>\n",
       "      <td>16.0</td>\n",
       "      <td>116.83</td>\n",
       "      <td>11.0</td>\n",
       "      <td>1.856904</td>\n",
       "      <td>7.301875</td>\n",
       "      <td>70</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">1006</th>\n",
       "      <th>11</th>\n",
       "      <td>2.0</td>\n",
       "      <td>9.32</td>\n",
       "      <td>15.0</td>\n",
       "      <td>2.019893</td>\n",
       "      <td>4.660000</td>\n",
       "      <td>70</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>9.0</td>\n",
       "      <td>54.79</td>\n",
       "      <td>139.0</td>\n",
       "      <td>31.366035</td>\n",
       "      <td>6.087778</td>\n",
       "      <td>70</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">1008</th>\n",
       "      <th>10</th>\n",
       "      <td>71.0</td>\n",
       "      <td>450.21</td>\n",
       "      <td>21.0</td>\n",
       "      <td>16.706045</td>\n",
       "      <td>6.340986</td>\n",
       "      <td>70</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>63.0</td>\n",
       "      <td>422.81</td>\n",
       "      <td>37.0</td>\n",
       "      <td>23.121797</td>\n",
       "      <td>6.711270</td>\n",
       "      <td>70</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               call_count  total_minutes  message_count    gb_used  \\\n",
       "user_id month                                                        \n",
       "1000    12           16.0         116.83           11.0   1.856904   \n",
       "1006    11            2.0           9.32           15.0   2.019893   \n",
       "        12            9.0          54.79          139.0  31.366035   \n",
       "1008    10           71.0         450.21           21.0  16.706045   \n",
       "        11           63.0         422.81           37.0  23.121797   \n",
       "\n",
       "               avg_duration  plan_cost  minutes_revenue  \n",
       "user_id month                                            \n",
       "1000    12         7.301875         70                0  \n",
       "1006    11         4.660000         70                0  \n",
       "        12         6.087778         70                0  \n",
       "1008    10         6.340986         70                0  \n",
       "        11         6.711270         70                0  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "minutes_revenue = []\n",
    "messages_revenue = []\n",
    "internet_revenue = []\n",
    "for each in ultimate_users['total_minutes']:\n",
    "    if each > 3000:\n",
    "        minutes = each - 3000\n",
    "        min_cost = minutes * 0.01\n",
    "        minutes_revenue.append(min_cost)\n",
    "    else: \n",
    "        minutes_revenue.append(0)\n",
    "ultimate_users['minutes_revenue'] = minutes_revenue\n",
    "display(ultimate_users.head())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_59/3674733045.py:8: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  ultimate_users['messages_revenue'] = messages_revenue\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>call_count</th>\n",
       "      <th>total_minutes</th>\n",
       "      <th>message_count</th>\n",
       "      <th>gb_used</th>\n",
       "      <th>avg_duration</th>\n",
       "      <th>plan_cost</th>\n",
       "      <th>minutes_revenue</th>\n",
       "      <th>messages_revenue</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>user_id</th>\n",
       "      <th>month</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1000</th>\n",
       "      <th>12</th>\n",
       "      <td>16.0</td>\n",
       "      <td>116.83</td>\n",
       "      <td>11.0</td>\n",
       "      <td>1.856904</td>\n",
       "      <td>7.301875</td>\n",
       "      <td>70</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">1006</th>\n",
       "      <th>11</th>\n",
       "      <td>2.0</td>\n",
       "      <td>9.32</td>\n",
       "      <td>15.0</td>\n",
       "      <td>2.019893</td>\n",
       "      <td>4.660000</td>\n",
       "      <td>70</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>9.0</td>\n",
       "      <td>54.79</td>\n",
       "      <td>139.0</td>\n",
       "      <td>31.366035</td>\n",
       "      <td>6.087778</td>\n",
       "      <td>70</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">1008</th>\n",
       "      <th>10</th>\n",
       "      <td>71.0</td>\n",
       "      <td>450.21</td>\n",
       "      <td>21.0</td>\n",
       "      <td>16.706045</td>\n",
       "      <td>6.340986</td>\n",
       "      <td>70</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>63.0</td>\n",
       "      <td>422.81</td>\n",
       "      <td>37.0</td>\n",
       "      <td>23.121797</td>\n",
       "      <td>6.711270</td>\n",
       "      <td>70</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               call_count  total_minutes  message_count    gb_used  \\\n",
       "user_id month                                                        \n",
       "1000    12           16.0         116.83           11.0   1.856904   \n",
       "1006    11            2.0           9.32           15.0   2.019893   \n",
       "        12            9.0          54.79          139.0  31.366035   \n",
       "1008    10           71.0         450.21           21.0  16.706045   \n",
       "        11           63.0         422.81           37.0  23.121797   \n",
       "\n",
       "               avg_duration  plan_cost  minutes_revenue  messages_revenue  \n",
       "user_id month                                                              \n",
       "1000    12         7.301875         70                0                 0  \n",
       "1006    11         4.660000         70                0                 0  \n",
       "        12         6.087778         70                0                 0  \n",
       "1008    10         6.340986         70                0                 0  \n",
       "        11         6.711270         70                0                 0  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "for each in ultimate_users['message_count']:\n",
    "    if each > 1000:\n",
    "        message = each - 1000\n",
    "        mess_cost = minutes * 0.01\n",
    "        messages_revenue.append(mess_cost)\n",
    "    else: \n",
    "        messages_revenue.append(0)\n",
    "ultimate_users['messages_revenue'] = messages_revenue\n",
    "display(ultimate_users.head())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 89,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_59/457877408.py:9: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  ultimate_users['internet_revenue'] = internet_revenue\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>call_count</th>\n",
       "      <th>total_minutes</th>\n",
       "      <th>message_count</th>\n",
       "      <th>gb_used</th>\n",
       "      <th>avg_duration</th>\n",
       "      <th>plan_cost</th>\n",
       "      <th>minutes_revenue</th>\n",
       "      <th>messages_revenue</th>\n",
       "      <th>internet_revenue</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>user_id</th>\n",
       "      <th>month</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1000</th>\n",
       "      <th>12</th>\n",
       "      <td>16.0</td>\n",
       "      <td>116.83</td>\n",
       "      <td>11.0</td>\n",
       "      <td>1.856904</td>\n",
       "      <td>7.301875</td>\n",
       "      <td>70</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">1006</th>\n",
       "      <th>11</th>\n",
       "      <td>2.0</td>\n",
       "      <td>9.32</td>\n",
       "      <td>15.0</td>\n",
       "      <td>2.019893</td>\n",
       "      <td>4.660000</td>\n",
       "      <td>70</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>9.0</td>\n",
       "      <td>54.79</td>\n",
       "      <td>139.0</td>\n",
       "      <td>31.366035</td>\n",
       "      <td>6.087778</td>\n",
       "      <td>70</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">1008</th>\n",
       "      <th>10</th>\n",
       "      <td>71.0</td>\n",
       "      <td>450.21</td>\n",
       "      <td>21.0</td>\n",
       "      <td>16.706045</td>\n",
       "      <td>6.340986</td>\n",
       "      <td>70</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>63.0</td>\n",
       "      <td>422.81</td>\n",
       "      <td>37.0</td>\n",
       "      <td>23.121797</td>\n",
       "      <td>6.711270</td>\n",
       "      <td>70</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               call_count  total_minutes  message_count    gb_used  \\\n",
       "user_id month                                                        \n",
       "1000    12           16.0         116.83           11.0   1.856904   \n",
       "1006    11            2.0           9.32           15.0   2.019893   \n",
       "        12            9.0          54.79          139.0  31.366035   \n",
       "1008    10           71.0         450.21           21.0  16.706045   \n",
       "        11           63.0         422.81           37.0  23.121797   \n",
       "\n",
       "               avg_duration  plan_cost  minutes_revenue  messages_revenue  \\\n",
       "user_id month                                                               \n",
       "1000    12         7.301875         70                0                 0   \n",
       "1006    11         4.660000         70                0                 0   \n",
       "        12         6.087778         70                0                 0   \n",
       "1008    10         6.340986         70                0                 0   \n",
       "        11         6.711270         70                0                 0   \n",
       "\n",
       "               internet_revenue  \n",
       "user_id month                    \n",
       "1000    12                    0  \n",
       "1006    11                    0  \n",
       "        12                   14  \n",
       "1008    10                    0  \n",
       "        11                    0  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>call_count</th>\n",
       "      <th>total_minutes</th>\n",
       "      <th>message_count</th>\n",
       "      <th>gb_used</th>\n",
       "      <th>avg_duration</th>\n",
       "      <th>plan_cost</th>\n",
       "      <th>minutes_revenue</th>\n",
       "      <th>messages_revenue</th>\n",
       "      <th>internet_revenue</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>713.000000</td>\n",
       "      <td>713.000000</td>\n",
       "      <td>584.000000</td>\n",
       "      <td>719.000000</td>\n",
       "      <td>713.000000</td>\n",
       "      <td>720.0</td>\n",
       "      <td>720.0</td>\n",
       "      <td>720.0</td>\n",
       "      <td>720.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>61.221599</td>\n",
       "      <td>410.180954</td>\n",
       "      <td>46.296233</td>\n",
       "      <td>16.834612</td>\n",
       "      <td>6.678253</td>\n",
       "      <td>70.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.313889</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>32.855296</td>\n",
       "      <td>224.745705</td>\n",
       "      <td>32.942118</td>\n",
       "      <td>7.647479</td>\n",
       "      <td>0.936871</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11.395108</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>2.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.227705</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>70.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>37.000000</td>\n",
       "      <td>247.970000</td>\n",
       "      <td>21.000000</td>\n",
       "      <td>12.374150</td>\n",
       "      <td>6.206875</td>\n",
       "      <td>70.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>61.000000</td>\n",
       "      <td>399.980000</td>\n",
       "      <td>41.000000</td>\n",
       "      <td>16.468213</td>\n",
       "      <td>6.687698</td>\n",
       "      <td>70.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>80.000000</td>\n",
       "      <td>534.820000</td>\n",
       "      <td>66.000000</td>\n",
       "      <td>20.532378</td>\n",
       "      <td>7.245000</td>\n",
       "      <td>70.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>191.000000</td>\n",
       "      <td>1292.090000</td>\n",
       "      <td>166.000000</td>\n",
       "      <td>45.503252</td>\n",
       "      <td>10.696000</td>\n",
       "      <td>70.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>112.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       call_count  total_minutes  message_count     gb_used  avg_duration  \\\n",
       "count  713.000000     713.000000     584.000000  719.000000    713.000000   \n",
       "mean    61.221599     410.180954      46.296233   16.834612      6.678253   \n",
       "std     32.855296     224.745705      32.942118    7.647479      0.936871   \n",
       "min      2.000000       0.000000       1.000000    0.227705      0.000000   \n",
       "25%     37.000000     247.970000      21.000000   12.374150      6.206875   \n",
       "50%     61.000000     399.980000      41.000000   16.468213      6.687698   \n",
       "75%     80.000000     534.820000      66.000000   20.532378      7.245000   \n",
       "max    191.000000    1292.090000     166.000000   45.503252     10.696000   \n",
       "\n",
       "       plan_cost  minutes_revenue  messages_revenue  internet_revenue  \n",
       "count      720.0            720.0             720.0        720.000000  \n",
       "mean        70.0              0.0               0.0          2.313889  \n",
       "std          0.0              0.0               0.0         11.395108  \n",
       "min         70.0              0.0               0.0          0.000000  \n",
       "25%         70.0              0.0               0.0          0.000000  \n",
       "50%         70.0              0.0               0.0          0.000000  \n",
       "75%         70.0              0.0               0.0          0.000000  \n",
       "max         70.0              0.0               0.0        112.000000  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "\n",
    "for each in ultimate_users['gb_used']:\n",
    "    if each > 30:\n",
    "        gb = mt.ceil((each - 30))\n",
    "        gb_rev = gb * 7\n",
    "        internet_revenue.append(gb_rev)\n",
    "    else: \n",
    "        internet_revenue.append(0)\n",
    "\n",
    "ultimate_users['internet_revenue'] = internet_revenue\n",
    "display(ultimate_users.head())\n",
    "display(ultimate_users.describe())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The process of adding the revenue from messages, calls, and internet will now be applied to the surf users. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_59/3877824727.py:11: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  surf_users['minutes_revenue'] = s_minutes_revenue\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>call_count</th>\n",
       "      <th>total_minutes</th>\n",
       "      <th>message_count</th>\n",
       "      <th>gb_used</th>\n",
       "      <th>avg_duration</th>\n",
       "      <th>plan_cost</th>\n",
       "      <th>minutes_revenue</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>user_id</th>\n",
       "      <th>month</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">1001</th>\n",
       "      <th>8</th>\n",
       "      <td>27.0</td>\n",
       "      <td>171.14</td>\n",
       "      <td>30.0</td>\n",
       "      <td>6.756982</td>\n",
       "      <td>6.338519</td>\n",
       "      <td>20</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>49.0</td>\n",
       "      <td>297.69</td>\n",
       "      <td>44.0</td>\n",
       "      <td>13.002754</td>\n",
       "      <td>6.075306</td>\n",
       "      <td>20</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>65.0</td>\n",
       "      <td>374.11</td>\n",
       "      <td>53.0</td>\n",
       "      <td>21.807119</td>\n",
       "      <td>5.755538</td>\n",
       "      <td>20</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>64.0</td>\n",
       "      <td>404.59</td>\n",
       "      <td>36.0</td>\n",
       "      <td>18.070605</td>\n",
       "      <td>6.321719</td>\n",
       "      <td>20</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>56.0</td>\n",
       "      <td>392.93</td>\n",
       "      <td>44.0</td>\n",
       "      <td>18.915215</td>\n",
       "      <td>7.016607</td>\n",
       "      <td>20</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               call_count  total_minutes  message_count    gb_used  \\\n",
       "user_id month                                                        \n",
       "1001    8            27.0         171.14           30.0   6.756982   \n",
       "        9            49.0         297.69           44.0  13.002754   \n",
       "        10           65.0         374.11           53.0  21.807119   \n",
       "        11           64.0         404.59           36.0  18.070605   \n",
       "        12           56.0         392.93           44.0  18.915215   \n",
       "\n",
       "               avg_duration  plan_cost  minutes_revenue  \n",
       "user_id month                                            \n",
       "1001    8          6.338519         20              0.0  \n",
       "        9          6.075306         20              0.0  \n",
       "        10         5.755538         20              0.0  \n",
       "        11         6.321719         20              0.0  \n",
       "        12         7.016607         20              0.0  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "s_minutes_revenue = []\n",
    "s_messages_revenue = []\n",
    "s_internet_revenue = []\n",
    "for each in surf_users['total_minutes']:\n",
    "    if each > 500:\n",
    "        minutes = each - 500\n",
    "        min_cost = minutes * 0.03\n",
    "        s_minutes_revenue.append(min_cost)\n",
    "    else: \n",
    "        s_minutes_revenue.append(0)\n",
    "surf_users['minutes_revenue'] = s_minutes_revenue\n",
    "display(surf_users.head())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 91,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_59/1598288076.py:8: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  surf_users['messages_revenue'] = s_messages_revenue\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>call_count</th>\n",
       "      <th>total_minutes</th>\n",
       "      <th>message_count</th>\n",
       "      <th>gb_used</th>\n",
       "      <th>avg_duration</th>\n",
       "      <th>plan_cost</th>\n",
       "      <th>minutes_revenue</th>\n",
       "      <th>messages_revenue</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>user_id</th>\n",
       "      <th>month</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">1001</th>\n",
       "      <th>8</th>\n",
       "      <td>27.0</td>\n",
       "      <td>171.14</td>\n",
       "      <td>30.0</td>\n",
       "      <td>6.756982</td>\n",
       "      <td>6.338519</td>\n",
       "      <td>20</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>49.0</td>\n",
       "      <td>297.69</td>\n",
       "      <td>44.0</td>\n",
       "      <td>13.002754</td>\n",
       "      <td>6.075306</td>\n",
       "      <td>20</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>65.0</td>\n",
       "      <td>374.11</td>\n",
       "      <td>53.0</td>\n",
       "      <td>21.807119</td>\n",
       "      <td>5.755538</td>\n",
       "      <td>20</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.3409</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>64.0</td>\n",
       "      <td>404.59</td>\n",
       "      <td>36.0</td>\n",
       "      <td>18.070605</td>\n",
       "      <td>6.321719</td>\n",
       "      <td>20</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>56.0</td>\n",
       "      <td>392.93</td>\n",
       "      <td>44.0</td>\n",
       "      <td>18.915215</td>\n",
       "      <td>7.016607</td>\n",
       "      <td>20</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               call_count  total_minutes  message_count    gb_used  \\\n",
       "user_id month                                                        \n",
       "1001    8            27.0         171.14           30.0   6.756982   \n",
       "        9            49.0         297.69           44.0  13.002754   \n",
       "        10           65.0         374.11           53.0  21.807119   \n",
       "        11           64.0         404.59           36.0  18.070605   \n",
       "        12           56.0         392.93           44.0  18.915215   \n",
       "\n",
       "               avg_duration  plan_cost  minutes_revenue  messages_revenue  \n",
       "user_id month                                                              \n",
       "1001    8          6.338519         20              0.0            0.0000  \n",
       "        9          6.075306         20              0.0            0.0000  \n",
       "        10         5.755538         20              0.0            2.3409  \n",
       "        11         6.321719         20              0.0            0.0000  \n",
       "        12         7.016607         20              0.0            0.0000  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "for each in surf_users['message_count']:\n",
    "    if each > 50:\n",
    "        message = each - 50\n",
    "        mess_cost = minutes * 0.03\n",
    "        s_messages_revenue.append(mess_cost)\n",
    "    else: \n",
    "        s_messages_revenue.append(0)\n",
    "surf_users['messages_revenue'] = s_messages_revenue\n",
    "display(surf_users.head())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_59/331975430.py:9: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  surf_users['internet_revenue'] = s_internet_revenue\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>call_count</th>\n",
       "      <th>total_minutes</th>\n",
       "      <th>message_count</th>\n",
       "      <th>gb_used</th>\n",
       "      <th>avg_duration</th>\n",
       "      <th>plan_cost</th>\n",
       "      <th>minutes_revenue</th>\n",
       "      <th>messages_revenue</th>\n",
       "      <th>internet_revenue</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>user_id</th>\n",
       "      <th>month</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">1001</th>\n",
       "      <th>8</th>\n",
       "      <td>27.0</td>\n",
       "      <td>171.14</td>\n",
       "      <td>30.0</td>\n",
       "      <td>6.756982</td>\n",
       "      <td>6.338519</td>\n",
       "      <td>20</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>49.0</td>\n",
       "      <td>297.69</td>\n",
       "      <td>44.0</td>\n",
       "      <td>13.002754</td>\n",
       "      <td>6.075306</td>\n",
       "      <td>20</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>65.0</td>\n",
       "      <td>374.11</td>\n",
       "      <td>53.0</td>\n",
       "      <td>21.807119</td>\n",
       "      <td>5.755538</td>\n",
       "      <td>20</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.3409</td>\n",
       "      <td>70</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>64.0</td>\n",
       "      <td>404.59</td>\n",
       "      <td>36.0</td>\n",
       "      <td>18.070605</td>\n",
       "      <td>6.321719</td>\n",
       "      <td>20</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>40</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>56.0</td>\n",
       "      <td>392.93</td>\n",
       "      <td>44.0</td>\n",
       "      <td>18.915215</td>\n",
       "      <td>7.016607</td>\n",
       "      <td>20</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>40</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               call_count  total_minutes  message_count    gb_used  \\\n",
       "user_id month                                                        \n",
       "1001    8            27.0         171.14           30.0   6.756982   \n",
       "        9            49.0         297.69           44.0  13.002754   \n",
       "        10           65.0         374.11           53.0  21.807119   \n",
       "        11           64.0         404.59           36.0  18.070605   \n",
       "        12           56.0         392.93           44.0  18.915215   \n",
       "\n",
       "               avg_duration  plan_cost  minutes_revenue  messages_revenue  \\\n",
       "user_id month                                                               \n",
       "1001    8          6.338519         20              0.0            0.0000   \n",
       "        9          6.075306         20              0.0            0.0000   \n",
       "        10         5.755538         20              0.0            2.3409   \n",
       "        11         6.321719         20              0.0            0.0000   \n",
       "        12         7.016607         20              0.0            0.0000   \n",
       "\n",
       "               internet_revenue  \n",
       "user_id month                    \n",
       "1001    8                     0  \n",
       "        9                     0  \n",
       "        10                   70  \n",
       "        11                   40  \n",
       "        12                   40  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>call_count</th>\n",
       "      <th>total_minutes</th>\n",
       "      <th>message_count</th>\n",
       "      <th>gb_used</th>\n",
       "      <th>avg_duration</th>\n",
       "      <th>plan_cost</th>\n",
       "      <th>minutes_revenue</th>\n",
       "      <th>messages_revenue</th>\n",
       "      <th>internet_revenue</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>1545.000000</td>\n",
       "      <td>1545.000000</td>\n",
       "      <td>1222.000000</td>\n",
       "      <td>1558.000000</td>\n",
       "      <td>1545.000000</td>\n",
       "      <td>1573.0</td>\n",
       "      <td>1573.000000</td>\n",
       "      <td>1573.000000</td>\n",
       "      <td>1573.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>60.895793</td>\n",
       "      <td>412.097890</td>\n",
       "      <td>40.109656</td>\n",
       "      <td>16.325881</td>\n",
       "      <td>6.756734</td>\n",
       "      <td>20.0</td>\n",
       "      <td>1.464708</td>\n",
       "      <td>0.505980</td>\n",
       "      <td>38.652257</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>31.268044</td>\n",
       "      <td>216.797727</td>\n",
       "      <td>33.035500</td>\n",
       "      <td>7.699886</td>\n",
       "      <td>1.096317</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.302048</td>\n",
       "      <td>0.963858</td>\n",
       "      <td>54.456269</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.090146</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>20.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>40.000000</td>\n",
       "      <td>262.780000</td>\n",
       "      <td>16.000000</td>\n",
       "      <td>11.902300</td>\n",
       "      <td>6.185048</td>\n",
       "      <td>20.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>60.000000</td>\n",
       "      <td>405.710000</td>\n",
       "      <td>32.000000</td>\n",
       "      <td>16.527178</td>\n",
       "      <td>6.744565</td>\n",
       "      <td>20.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>20.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>80.000000</td>\n",
       "      <td>546.230000</td>\n",
       "      <td>54.000000</td>\n",
       "      <td>20.546738</td>\n",
       "      <td>7.278750</td>\n",
       "      <td>20.0</td>\n",
       "      <td>1.310400</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>60.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>205.000000</td>\n",
       "      <td>1431.220000</td>\n",
       "      <td>266.000000</td>\n",
       "      <td>69.269131</td>\n",
       "      <td>18.750000</td>\n",
       "      <td>20.0</td>\n",
       "      <td>27.936600</td>\n",
       "      <td>2.340900</td>\n",
       "      <td>550.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        call_count  total_minutes  message_count      gb_used  avg_duration  \\\n",
       "count  1545.000000    1545.000000    1222.000000  1558.000000   1545.000000   \n",
       "mean     60.895793     412.097890      40.109656    16.325881      6.756734   \n",
       "std      31.268044     216.797727      33.035500     7.699886      1.096317   \n",
       "min       1.000000       0.000000       1.000000     0.090146      0.000000   \n",
       "25%      40.000000     262.780000      16.000000    11.902300      6.185048   \n",
       "50%      60.000000     405.710000      32.000000    16.527178      6.744565   \n",
       "75%      80.000000     546.230000      54.000000    20.546738      7.278750   \n",
       "max     205.000000    1431.220000     266.000000    69.269131     18.750000   \n",
       "\n",
       "       plan_cost  minutes_revenue  messages_revenue  internet_revenue  \n",
       "count     1573.0      1573.000000       1573.000000       1573.000000  \n",
       "mean        20.0         1.464708          0.505980         38.652257  \n",
       "std          0.0         3.302048          0.963858         54.456269  \n",
       "min         20.0         0.000000          0.000000          0.000000  \n",
       "25%         20.0         0.000000          0.000000          0.000000  \n",
       "50%         20.0         0.000000          0.000000         20.000000  \n",
       "75%         20.0         1.310400          0.000000         60.000000  \n",
       "max         20.0        27.936600          2.340900        550.000000  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "for each in surf_users['gb_used']:\n",
    "    if each > 15:\n",
    "        gb = mt.ceil((each - 15))\n",
    "        gb_rev = gb * 10\n",
    "        s_internet_revenue.append(gb_rev)\n",
    "    else: \n",
    "        s_internet_revenue.append(0)\n",
    "\n",
    "surf_users['internet_revenue'] = s_internet_revenue\n",
    "display(surf_users.head())\n",
    "display(surf_users.describe())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 93,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_59/1842816850.py:2: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  ultimate_users['total_revenue'] = ultimate_users['minutes_revenue'] + ultimate_users['messages_revenue'] + ultimate_users['internet_revenue'] + ultimate_users['plan_cost']\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "user_id  month\n",
       "1000     12       70\n",
       "1006     11       70\n",
       "         12       84\n",
       "1008     10       70\n",
       "         11       70\n",
       "Name: total_revenue, dtype: int64"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_59/1842816850.py:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  surf_users['total_revenue'] = surf_users['minutes_revenue'] + surf_users['messages_revenue'] + surf_users['internet_revenue'] + surf_users['plan_cost']\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "user_id  month\n",
       "1001     8        20.0000\n",
       "         9        20.0000\n",
       "         10       92.3409\n",
       "         11       60.0000\n",
       "         12       60.0000\n",
       "Name: total_revenue, dtype: float64"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Calculate the monthly revenue for each user\n",
    "ultimate_users['total_revenue'] = ultimate_users['minutes_revenue'] + ultimate_users['messages_revenue'] + ultimate_users['internet_revenue'] + ultimate_users['plan_cost']\n",
    "display(ultimate_users['total_revenue'].head())\n",
    "surf_users['total_revenue'] = surf_users['minutes_revenue'] + surf_users['messages_revenue'] + surf_users['internet_revenue'] + surf_users['plan_cost']\n",
    "display(surf_users['total_revenue'].head())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Study user behaviour"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Calls"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Compare average duration of calls per each plan per each distinct month. Plot a bar plot to visualize it.\n",
    "u_monthly_avg = ultimate_users.groupby('month').mean()\n",
    "s_monthly_avg = surf_users.groupby('month').mean()\n",
    "monthly_avg = u_monthly_avg.merge(s_monthly_avg, right_on = 'month', left_on = 'month')\n",
    "monthly_avg[['avg_duration_x', 'avg_duration_y']].plot(kind = 'bar',ylabel = 'Total Minutes', title = 'Comparison of call duration each month')\n",
    "plt.legend(['Ultimate', 'Surf'])\n",
    "\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Users in both plans have similar call durations. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Compare the number of minutes users of each plan require each month. Plot a histogram.\n",
    "monthly_avg[['total_minutes_x', 'total_minutes_y']].plot(kind = 'hist',\n",
    "                                                         ylabel = 'Total Minutes', \n",
    "                                                         title = 'Comparison of minutes each month', \n",
    "                                                         alpha = 0.5, bins = 50)\n",
    "plt.legend(['Ultimate', 'Surf'])\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Neither plans have a normal distribution of total minutes, but it seems to be skewed to the left. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Ultimate: 6.581388143643348 0.09351483263219192\n",
      "Surf: 6.682611722485064 0.024926215246246483\n"
     ]
    }
   ],
   "source": [
    "# Calculate the mean and the variance of the monthly call duration\n",
    "print('Ultimate:', monthly_avg['avg_duration_x'].mean(), np.var(monthly_avg['avg_duration_x']))\n",
    "print('Surf:', monthly_avg['avg_duration_y'].mean(), np.var(monthly_avg['avg_duration_y']))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Both plans have similar avgerages and the ultimate plan has a higher variance for call duration. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 97,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Plot a boxplot to visualize the distribution of the monthly call duration\n",
    "monthly_avg[['avg_duration_x', 'avg_duration_y']].boxplot()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "The ultimate plan users are shown first, although there are more and farther outliers on the boxplot, the interquartile range is smaller. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Messages"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 98,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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mFmxdNg2/uaGnvvrqu6v8eJjqravyy67jE9+8pP06tULoGrJesmSJSxcuJDJkye3vbKZbdfK5bBq5iNwjT933/3ud3n22WeZMGECEyZkNy0aOnQoa9asobGxkX322Ydp06ax1157cfLJJ3Pbbbdx6KGHMmLECBYsWADAggUL+OAHP8iYMWM45JBDeOyxx3j99de54IILuP766xk9ejTXX389L7/8MqeeeioHHXQQY8aM4ZZbbqnnoZvZdsqJP2dnnnkmgwcPZv78+cyfP/8dy5cvX84Xv/hFli1bxrJly7jmmmu45557mDlzJt/85jcB2Geffbj77rtZvHgxF154Ieeffz477LADF154ISeccAJLlizhhBNO4KKLLmLixIksWLCA+fPnc/bZZ/Pyyy/X+pDNbDvXaZp66qG1C6VbcwF12LBhjBo1CoCRI0dy+OGHI4lRo0bR2NgIwPr165k6dSqPP/44kti0aVOL+5o3bx5z5sxh5syZQNbz6amnnuK9733vVhyVmXV2TvzboH///rz44otbzHvhhRe2qo98jx493pru0qXLW4+7dOnC5s2bAZg+fToTJkzg5ptvprGxkfHjx7e4r4jgpptuYu+9997KIzGzInFTzzbo3bs3gwYN4o477gCypP/b3/6WcePGbbFenz592LBhQ7vLWb9+PbvuuisAV155Zav7PfLII/ne975H013VFi9e3O4yzazzcuLfRldddRVf//rXGT16NBMnTuSrX/0qw4cP32Kd008/naOOOuqti7tb65xzzuG8885jzJgxb30LAJgwYQKPPvroWxd3p0+fzqZNm9h///0ZOXIk06dP36ZjM7POqUPcc3fs2LHRfDz+pUuXuu26nXzuzLY/eXTnlLQoIsY2n+8av5lZwTjxm5kVjBO/mVnBOPGbmRVMrv34JTUCG4A3gM0RMVbSLsD1wFCgEfh4RLzY2j7MzKy6alHjnxARo0uuLJ8L3B4RI4Db02MzM6uRejT1HAfMTtOzgSl1iKEqLrroIkaOHMn+++/P6NGjue+++7Zq+xNPPJH999+fSy+9NKcIzczeKe8hGwKYJymAyyNiFjAwIlam5auAgS1tKOl04HSA3Xffve2SZuxcjXhL9re+7OJ7772XuXPn8sADD9CjRw/WrFnD66+/XtGuN2/ezJo1a7j//vtZvnx5NaI1M6tY3jX+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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Compare the number of messages users of each plan tend to send each month\n",
    "monthly_avg[['message_count_x', 'message_count_y']].plot(kind = 'bar',\n",
    "                                                         ylabel = 'Total Messages', \n",
    "                                                         title = 'Comparison of messages each month')\n",
    "plt.legend(['Ultimate', 'Surf'])\n",
    "\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Users on the ultimate plan generally text more each month. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 99,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Ultimate: 39.47232523405716 97.76741194313193\n",
      "Surf: 33.30976679539808 77.24233718034748\n"
     ]
    }
   ],
   "source": [
    "print('Ultimate:', monthly_avg['message_count_x'].mean(), np.var(monthly_avg['message_count_x']))\n",
    "print('Surf:', monthly_avg['message_count_y'].mean(), np.var(monthly_avg['message_count_y']))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The averages of each plan is similar with ultimate being slightly higher, but the variance for ultimate users is a lot higher at 97.77. Although the sample size for the ultimate plan is lower which can cause higher variance. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 100,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "monthly_avg[['message_count_x', 'message_count_y']].plot(kind = 'hist', \n",
    "                                                        title = 'Frequency of messages for each plan', \n",
    "                                                        bins = 20, \n",
    "                                                        alpha = 0.5)\n",
    "plt.legend(['Ultimate', 'Surfer'])\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 101,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Compare the amount of internet traffic consumed by users per plan\n",
    "monthly_avg[['gb_used_x', 'gb_used_y']].plot(kind = 'bar',ylabel = 'GB', title = 'Comparison of internet used each month')\n",
    "plt.legend(['Ultimate', 'Surf'])\n",
    "\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Users on the ultimate plan generally use more internet then users on the surf plan for the first 5 months of the year but users on the surf plan increase to be level with users on the ultimate plan.  "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Internet"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 102,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Ultimate: 15.846271234979925 8.214285012938397\n",
      "Surf: 14.262930910216896 11.91086846813702\n"
     ]
    }
   ],
   "source": [
    "print('Ultimate:', monthly_avg['gb_used_x'].mean(), np.var(monthly_avg['gb_used_x']))\n",
    "print('Surf:', monthly_avg['gb_used_y'].mean(), np.var(monthly_avg['gb_used_y']))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 103,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "monthly_avg[['gb_used_x', 'gb_used_y']].plot(kind = 'hist', \n",
    "                                                        title = 'Frequency of internet usage for each plan', \n",
    "                                                        bins = 50, \n",
    "                                                        alpha = 0.5)\n",
    "plt.legend(['Ultimate', 'Surfer'])\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Looking at the histogram above we can see there are more ultimate plan users that use a higher amount of internet. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Revenue"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 104,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "monthly_avg[['total_revenue_x', 'total_revenue_y']].plot(kind = 'bar',ylabel = 'Average Revenue', title = 'Comparison of Revenue each month')\n",
    "plt.legend(['Ultimate', 'Surf'])\n",
    "\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The monthly average revenue is higher for the ultimate plan every month. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Ultimate: 72.01106825881764 1.7056240167926762\n",
      "Surf: 51.33285558431853 197.24178293433133\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "print('Ultimate:', monthly_avg['total_revenue_x'].mean(), np.var(monthly_avg['total_revenue_x']))\n",
    "print('Surf:', monthly_avg['total_revenue_y'].mean(), np.var(monthly_avg['total_revenue_y']))\n",
    "monthly_avg[['total_revenue_x', 'total_revenue_y']].plot(kind = 'hist', \n",
    "                                                        title = 'Frequency of Revenue usage for each plan', \n",
    "                                                        bins = 50, \n",
    "                                                        alpha = 0.5)\n",
    "plt.legend(['Ultimate', 'Surfer'])\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "Overall the revenue for the ultimate plan is higher and has a small variance, the surf plan has a high variance so the revenue month-to-month has changed a lot. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    " "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Test statistical hypotheses"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "I want to see if the average revenue from users of Ultimate and Surf are the same or different. \n",
    "The null hypothesis will be: The average revenue of the plans are the same.\n",
    "The alternative hypothesis is that the average revenue of the plans are different. \n",
    "I am going to set the critical statistical significance level to 0.05. \n",
    "Above I had compared the variance between the the two plans, the surf plan has a larger variance so the equal_var will be set to False. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "p-value: 0.000476724021214518\n",
      "We reject the null hypothesis\n"
     ]
    }
   ],
   "source": [
    "# Test the hypotheses\n",
    "alpha = 0.05 # your code: set a critical statistical significance level\n",
    "\n",
    "results = st.ttest_ind(monthly_avg['total_revenue_x'], monthly_avg['total_revenue_y'], equal_var = False)\n",
    "\n",
    "print('p-value:', results.pvalue)\n",
    "\n",
    "if results.pvalue < alpha:\n",
    "    print(\"We reject the null hypothesis\")\n",
    "else:\n",
    "    print(\"We can't reject the null hypothesis\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "It can be concluded that the plans have different average revenues. In the charts above, it was clear that the ultimate plan had a higher average revenue. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "I want to compare the average revenue from users in the NY-NJ area to users in other regions. I will first need to prepare the data by grouping the revenue data by city and adding the revenue of both plans for each city. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 107,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "NY-NJ: 59.78453925729443 1891.079619901642\n",
      "Other: 65.18116925887264 2215.1140308340077\n"
     ]
    }
   ],
   "source": [
    "ny_region = users[users['city'] == 'New York-Newark-Jersey City']\n",
    "all_users = pd.concat([ultimate_users, surf_users])\n",
    "\n",
    "ny_users = all_users.query('user_id in @ny_region.user_id')\n",
    "other_users = all_users.query('user_id not in @ny_region.user_id')\n",
    "print('NY-NJ:', ny_users['total_revenue'].mean(), np.var(ny_users['total_revenue']))\n",
    "print('Other:', other_users['total_revenue'].mean(), np.var(other_users['total_revenue']))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "The null hypothesis will be that both regions' average revenue is statistically the same. \n",
    "The alternative hypothesis is that they are different. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "p-value: 0.030442760524132577\n",
      "We reject the null hypothesis\n"
     ]
    }
   ],
   "source": [
    "# Test the hypotheses\n",
    "alpha = 0.05 # your code: set a critical statistical significance level\n",
    "\n",
    "results = st.ttest_ind(ny_users['total_revenue'], other_users['total_revenue'], equal_var = False)\n",
    "\n",
    "print('p-value:', results.pvalue)\n",
    "\n",
    "if results.pvalue < alpha:\n",
    "    print(\"We reject the null hypothesis\")\n",
    "else:\n",
    "    print(\"We can't reject the null hypothesis\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The average revenue of the regions are significantly different with users in NY-NJ having a lower average revenue. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### General conclusions\n",
    "\n",
    "Starting off in section 1.6.2 I had calculated that the number of ultimate users in the sample was only 1/3 of the overall sample. Initially I had concerns if that would skew the data, however, going through the project I saw users on the ultimate plan consistently had a smaller variance in most all areas. \n",
    "\n",
    "The main assumption throughout this project is that the sample is representative of all the customers in the US. \n",
    "\n",
    "Looking in to plan behaviors I saw that average call duration was similar but ultimate users had a larger variance. \n",
    "Ultimate users generally sent more messages and both plans increased throughout the year. \n",
    "Ultimate useres generally used more internet.\n",
    "\n",
    "Average monthly revenue was higher from the ultimate plan than the surf plan. \n",
    "I used a t-test to determing if the difference was significant, and it was. \n",
    "\n",
    "NY-NJ had a smaller average monthly revenue compared to the rest of the cities. I used a t-test to determine if the difference was significant and it was. \n",
    "\n",
    "While I was charting the plan use behavior I noticed a trend of use increasing throughout the year. Further study could show if the increase was a result of the business growing each month. \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    " Based on this data the ultimate plan generates more revenue. "
   ]
  }
 ],
 "metadata": {
  "ExecuteTimeLog": [
   {
    "duration": 828,
    "start_time": "2021-11-16T09:21:11.304Z"
   },
   {
    "duration": 893,
    "start_time": "2021-11-16T09:21:17.728Z"
   },
   {
    "duration": 1150,
    "start_time": "2021-11-16T09:21:29.568Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T09:24:14.495Z"
   },
   {
    "duration": 120,
    "start_time": "2021-11-16T09:24:46.630Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T09:28:27.882Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-16T09:29:54.281Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T09:30:45.936Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-16T09:31:06.300Z"
   },
   {
    "duration": 113,
    "start_time": "2021-11-16T09:31:37.208Z"
   },
   {
    "duration": 143,
    "start_time": "2021-11-16T09:31:48.656Z"
   },
   {
    "duration": 98,
    "start_time": "2021-11-16T09:31:55.678Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T09:32:08.535Z"
   },
   {
    "duration": 111,
    "start_time": "2021-11-16T09:32:10.120Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T09:32:15.732Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-16T09:32:29.423Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T10:03:03.074Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T10:10:01.288Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T10:10:46.923Z"
   },
   {
    "duration": 121,
    "start_time": "2021-11-16T10:37:46.494Z"
   },
   {
    "duration": 125,
    "start_time": "2021-11-16T10:38:20.632Z"
   },
   {
    "duration": 112,
    "start_time": "2021-11-16T10:46:53.001Z"
   },
   {
    "duration": 110,
    "start_time": "2021-11-16T10:48:25.775Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T10:50:18.720Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-16T10:50:37.649Z"
   },
   {
    "duration": 2,
    "start_time": "2021-11-16T10:50:51.884Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T10:51:56.237Z"
   },
   {
    "duration": 101,
    "start_time": "2021-11-16T10:53:13.791Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T10:55:59.186Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T10:56:10.751Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T10:56:49.038Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T10:56:49.174Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-16T10:56:49.414Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T10:56:49.680Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T10:56:50.370Z"
   },
   {
    "duration": 114,
    "start_time": "2021-11-16T10:59:34.518Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T11:01:41.201Z"
   },
   {
    "duration": 116,
    "start_time": "2021-11-16T11:01:48.754Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T11:02:16.685Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T11:02:19.479Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T11:02:47.067Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T11:02:49.353Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T11:03:07.835Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T11:03:07.953Z"
   },
   {
    "duration": 112,
    "start_time": "2021-11-16T11:07:52.072Z"
   },
   {
    "duration": 187,
    "start_time": "2021-11-16T11:09:23.468Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-16T11:10:01.455Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T11:10:05.069Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-16T11:10:13.376Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T11:10:14.434Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T11:10:22.853Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-16T11:27:29.279Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-16T11:29:08.919Z"
   },
   {
    "duration": 118,
    "start_time": "2021-11-16T11:29:46.703Z"
   },
   {
    "duration": 437,
    "start_time": "2021-11-16T11:36:02.181Z"
   },
   {
    "duration": 157,
    "start_time": "2021-11-16T11:36:14.388Z"
   },
   {
    "duration": 207,
    "start_time": "2021-11-16T11:47:15.898Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T11:53:52.092Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T11:53:52.236Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T11:59:12.005Z"
   },
   {
    "duration": 112,
    "start_time": "2021-11-16T12:00:33.446Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T12:02:14.453Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-16T12:02:39.512Z"
   },
   {
    "duration": 106,
    "start_time": "2021-11-16T12:03:03.460Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T20:37:21.139Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T20:37:22.229Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T20:38:38.806Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T20:38:41.958Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T20:43:46.551Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-17T20:58:21.835Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T20:59:21.872Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-17T20:59:45.352Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-17T20:59:49.646Z"
   },
   {
    "duration": 159,
    "start_time": "2021-11-17T21:02:26.949Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:03:53.461Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:03:53.694Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:05:28.145Z"
   },
   {
    "duration": 116,
    "start_time": "2021-11-17T21:05:57.787Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:06:37.993Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:06:38.261Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:11:54.358Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:12:43.846Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-17T21:13:08.773Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:14:44.441Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:15:42.059Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-17T21:15:51.995Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:15:53.923Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:15:55.282Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:16:28.492Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:16:32.603Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:17:06.941Z"
   },
   {
    "duration": 98,
    "start_time": "2021-11-17T21:18:05.733Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-17T21:21:35.255Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:21:37.804Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-17T21:23:06.071Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:23:24.799Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:23:32.591Z"
   },
   {
    "duration": 98,
    "start_time": "2021-11-17T21:28:31.559Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:28:45.448Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:29:17.303Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:29:29.617Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:29:32.681Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:36:11.474Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:36:14.791Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:36:53.943Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:36:56.165Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-17T21:37:16.590Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:37:22.702Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-17T21:38:03.479Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:38:08.601Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:38:12.928Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:38:48.896Z"
   },
   {
    "duration": 2,
    "start_time": "2021-11-17T21:38:49.171Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-17T21:39:57.889Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:39:58.057Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:41:20.108Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:41:20.629Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:42:49.136Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:43:15.137Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-17T21:43:16.766Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-17T21:43:31.711Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:43:36.312Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-17T21:45:08.825Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-17T21:45:10.119Z"
   },
   {
    "duration": 4,
    "start_time": "2021-11-17T21:45:13.748Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:45:22.219Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:45:33.412Z"
   },
   {
    "duration": 2,
    "start_time": "2021-11-17T21:46:01.885Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-17T21:46:03.628Z"
   },
   {
    "duration": 107,
    "start_time": "2021-11-17T21:47:32.512Z"
   },
   {
    "duration": 103,
    "start_time": "2021-11-17T21:50:36.243Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-18T06:28:31.440Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-18T06:29:00.168Z"
   },
   {
    "duration": 3,
    "start_time": "2021-11-18T06:31:27.008Z"
   },
   {
    "duration": 2,
    "start_time": "2021-11-18T06:35:34.288Z"
   },
   {
    "duration": 2,
    "start_time": "2021-11-18T06:38:04.527Z"
   }
  ],
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.5"
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": true,
   "sideBar": true,
   "skip_h1_title": false,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {
    "height": "calc(100% - 180px)",
    "left": "10px",
    "top": "150px",
    "width": "512px"
   },
   "toc_section_display": true,
   "toc_window_display": false
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
